SELECT t5.c_last_name, t5.c_first_name, t5.ca_city, t5.bought_city, t5.ss_ticket_number, t5.extended_price, t5.extended_tax, t5.list_price FROM (SELECT t3.ss_ticket_number, t3.ss_customer_sk, t3.ca_city AS bought_city, t3.extended_price, t3.list_price, t3.extended_tax, customer.c_customer_sk, customer.c_customer_id, customer.c_current_cdemo_sk, customer.c_current_hdemo_sk, customer.c_current_addr_sk, customer.c_first_shipto_date_sk, customer.c_first_sales_date_sk, customer.c_salutation, customer.c_first_name, customer.c_last_name, customer.c_preferred_cust_flag, customer.c_birth_day, customer.c_birth_month, customer.c_birth_year, customer.c_birth_country, customer.c_login, customer.c_email_address, customer.c_last_review_date_sk, customer_address0.ca_address_sk, customer_address0.ca_address_id, customer_address0.ca_street_number, customer_address0.ca_street_name, customer_address0.ca_street_type, customer_address0.ca_suite_number, customer_address0.ca_city, customer_address0.ca_county, customer_address0.ca_state, customer_address0.ca_zip, customer_address0.ca_country, customer_address0.ca_gmt_offset, customer_address0.ca_location_type FROM (SELECT store_sales.ss_ticket_number, store_sales.ss_customer_sk, store_sales.ss_addr_sk, customer_address.ca_city, SUM(store_sales.ss_ext_sales_price) AS extended_price, SUM(store_sales.ss_ext_list_price) AS list_price, SUM(store_sales.ss_ext_tax) AS extended_tax FROM store_sales INNER JOIN (SELECT * FROM date_dim WHERE d_dom >= 1 AND d_dom <= 2 AND (d_year = 1998 OR d_year = 1998 + 1 OR d_year = 1998 + 2)) AS t ON store_sales.ss_sold_date_sk = t.d_date_sk INNER JOIN (SELECT * FROM store WHERE s_city IN ('Fairview', 'Midway')) AS t0 ON store_sales.ss_store_sk = t0.s_store_sk INNER JOIN (SELECT * FROM household_demographics WHERE hd_dep_count = 3 OR hd_vehicle_count = 4) AS t1 ON store_sales.ss_hdemo_sk = t1.hd_demo_sk INNER JOIN customer_address ON store_sales.ss_addr_sk = customer_address.ca_address_sk GROUP BY store_sales.ss_customer_sk, store_sales.ss_addr_sk, store_sales.ss_ticket_number, customer_address.ca_city) AS t3 INNER JOIN customer ON t3.ss_customer_sk = customer.c_customer_sk INNER JOIN customer_address AS customer_address0 ON customer.c_current_addr_sk = customer_address0.ca_address_sk AND customer_address0.ca_city <> t3.ca_city ORDER BY customer.c_last_name, t3.ss_ticket_number LIMIT 100) AS t5
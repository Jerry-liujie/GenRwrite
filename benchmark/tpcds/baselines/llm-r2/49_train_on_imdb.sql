SELECT * FROM (SELECT * FROM (SELECT 'web' AS channel, item, return_ratio, return_rank, currency_rank FROM (SELECT t1.item, CAST(t1.f1 AS DECIMAL(15, 4)) / CAST(t1.f2 AS DECIMAL(15, 4)) AS return_ratio, CAST(t1.f3 AS DECIMAL(15, 4)) / CAST(t1.f4 AS DECIMAL(15, 4)) AS currency_ratio, RANK() OVER (ORDER BY CAST(t1.f1 AS DECIMAL(15, 4)) / CAST(t1.f2 AS DECIMAL(15, 4))) AS return_rank, RANK() OVER (ORDER BY CAST(t1.f3 AS DECIMAL(15, 4)) / CAST(t1.f4 AS DECIMAL(15, 4))) AS currency_rank FROM (SELECT web_sales.ws_item_sk AS item, SUM(CASE WHEN web_returns.wr_return_quantity IS NOT NULL THEN CAST(web_returns.wr_return_quantity AS INTEGER) ELSE 0 END) AS f1, SUM(web_sales.ws_quantity) AS f2, SUM(CASE WHEN web_returns.wr_return_amt IS NOT NULL THEN CAST(web_returns.wr_return_amt AS DECIMAL(19, 0)) ELSE 0 END) AS f3, SUM(web_sales.ws_net_paid) AS f4 FROM web_sales LEFT JOIN web_returns ON web_sales.ws_order_number = web_returns.wr_order_number AND web_sales.ws_item_sk = web_returns.wr_item_sk CROSS JOIN date_dim WHERE web_returns.wr_return_amt > 10000 AND (web_sales.ws_net_profit > 1 AND web_sales.ws_net_paid > 0) AND (web_sales.ws_quantity > 0 AND web_sales.ws_sold_date_sk = date_dim.d_date_sk AND (date_dim.d_year = 1998 AND date_dim.d_moy = 11)) GROUP BY web_sales.ws_item_sk) AS t1) AS t2 WHERE return_rank <= 10 OR currency_rank <= 10 UNION SELECT 'catalog' AS channel, item, return_ratio, return_rank, currency_rank FROM (SELECT t7.item, CAST(t7.f1 AS DECIMAL(15, 4)) / CAST(t7.f2 AS DECIMAL(15, 4)) AS return_ratio, CAST(t7.f3 AS DECIMAL(15, 4)) / CAST(t7.f4 AS DECIMAL(15, 4)) AS currency_ratio, RANK() OVER (ORDER BY CAST(t7.f1 AS DECIMAL(15, 4)) / CAST(t7.f2 AS DECIMAL(15, 4))) AS return_rank, RANK() OVER (ORDER BY CAST(t7.f3 AS DECIMAL(15, 4)) / CAST(t7.f4 AS DECIMAL(15, 4))) AS currency_rank FROM (SELECT catalog_sales.cs_item_sk AS item, SUM(CASE WHEN catalog_returns.cr_return_quantity IS NOT NULL THEN CAST(catalog_returns.cr_return_quantity AS INTEGER) ELSE 0 END) AS f1, SUM(catalog_sales.cs_quantity) AS f2, SUM(CASE WHEN catalog_returns.cr_return_amount IS NOT NULL THEN CAST(catalog_returns.cr_return_amount AS DECIMAL(19, 0)) ELSE 0 END) AS f3, SUM(catalog_sales.cs_net_paid) AS f4 FROM catalog_sales LEFT JOIN catalog_returns ON catalog_sales.cs_order_number = catalog_returns.cr_order_number AND catalog_sales.cs_item_sk = catalog_returns.cr_item_sk CROSS JOIN date_dim AS date_dim0 WHERE catalog_returns.cr_return_amount > 10000 AND (catalog_sales.cs_net_profit > 1 AND catalog_sales.cs_net_paid > 0) AND (catalog_sales.cs_quantity > 0 AND catalog_sales.cs_sold_date_sk = date_dim0.d_date_sk AND (date_dim0.d_year = 1998 AND date_dim0.d_moy = 11)) GROUP BY catalog_sales.cs_item_sk) AS t7) AS t8 WHERE return_rank <= 10 OR currency_rank <= 10) AS t UNION SELECT 'store' AS channel, item, return_ratio, return_rank, currency_rank FROM (SELECT t14.item, CAST(t14.f1 AS DECIMAL(15, 4)) / CAST(t14.f2 AS DECIMAL(15, 4)) AS return_ratio, CAST(t14.f3 AS DECIMAL(15, 4)) / CAST(t14.f4 AS DECIMAL(15, 4)) AS currency_ratio, RANK() OVER (ORDER BY CAST(t14.f1 AS DECIMAL(15, 4)) / CAST(t14.f2 AS DECIMAL(15, 4))) AS return_rank, RANK() OVER (ORDER BY CAST(t14.f3 AS DECIMAL(15, 4)) / CAST(t14.f4 AS DECIMAL(15, 4))) AS currency_rank FROM (SELECT store_sales.ss_item_sk AS item, SUM(CASE WHEN store_returns.sr_return_quantity IS NOT NULL THEN CAST(store_returns.sr_return_quantity AS INTEGER) ELSE 0 END) AS f1, SUM(store_sales.ss_quantity) AS f2, SUM(CASE WHEN store_returns.sr_return_amt IS NOT NULL THEN CAST(store_returns.sr_return_amt AS DECIMAL(19, 0)) ELSE 0 END) AS f3, SUM(store_sales.ss_net_paid) AS f4 FROM store_sales LEFT JOIN store_returns ON store_sales.ss_ticket_number = store_returns.sr_ticket_number AND store_sales.ss_item_sk = store_returns.sr_item_sk CROSS JOIN date_dim AS date_dim1 WHERE store_returns.sr_return_amt > 10000 AND (store_sales.ss_net_profit > 1 AND store_sales.ss_net_paid > 0) AND (store_sales.ss_quantity > 0 AND store_sales.ss_sold_date_sk = date_dim1.d_date_sk AND (date_dim1.d_year = 1998 AND date_dim1.d_moy = 11)) GROUP BY store_sales.ss_item_sk) AS t14) AS t15 WHERE return_rank <= 10 OR currency_rank <= 10) AS t18 ORDER BY channel, return_rank, currency_rank, item LIMIT 100
SELECT t2.i_category, t2.i_brand, t2.cc_name, t2.d_year, t2.avg_monthly_sales, t2.sum_sales, t6.sum_sales AS psum, t10.sum_sales AS nsum FROM (SELECT t1.i_category, t1.i_brand, t1.cc_name, t1.d_year, t1.d_moy, t1.sum_sales, (SUM(t1.sum_sales) OVER (PARTITION BY t1.i_category, t1.i_brand, t1.cc_name, t1.d_year RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)) / (COUNT(t1.sum_sales) OVER (PARTITION BY t1.i_category, t1.i_brand, t1.cc_name, t1.d_year RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)) AS avg_monthly_sales, RANK() OVER (PARTITION BY t1.i_category, t1.i_brand, t1.cc_name ORDER BY t1.d_year, t1.d_moy) AS rn FROM (SELECT item.i_category, item.i_brand, call_center.cc_name, t.d_year, t.d_moy, SUM(catalog_sales.cs_sales_price) AS sum_sales FROM item INNER JOIN catalog_sales ON item.i_item_sk = catalog_sales.cs_item_sk INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2001 OR d_year = 2001 - 1 AND d_moy = 12 OR d_year = 2001 + 1 AND d_moy = 1) AS t ON catalog_sales.cs_sold_date_sk = t.d_date_sk INNER JOIN call_center ON catalog_sales.cs_call_center_sk = call_center.cc_call_center_sk GROUP BY item.i_category, item.i_brand, call_center.cc_name, t.d_year, t.d_moy) AS t1) AS t2 INNER JOIN (SELECT t5.i_category, t5.i_brand, t5.cc_name, t5.d_year, t5.d_moy, t5.sum_sales, (SUM(t5.sum_sales) OVER (PARTITION BY t5.i_category, t5.i_brand, t5.cc_name, t5.d_year RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)) / (COUNT(t5.sum_sales) OVER (PARTITION BY t5.i_category, t5.i_brand, t5.cc_name, t5.d_year RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)) AS avg_monthly_sales, RANK() OVER (PARTITION BY t5.i_category, t5.i_brand, t5.cc_name ORDER BY t5.d_year, t5.d_moy) AS rn FROM (SELECT item0.i_category, item0.i_brand, call_center0.cc_name, t3.d_year, t3.d_moy, SUM(catalog_sales0.cs_sales_price) AS sum_sales FROM item AS item0 INNER JOIN catalog_sales AS catalog_sales0 ON item0.i_item_sk = catalog_sales0.cs_item_sk INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2001 OR d_year = 2001 - 1 AND d_moy = 12 OR d_year = 2001 + 1 AND d_moy = 1) AS t3 ON catalog_sales0.cs_sold_date_sk = t3.d_date_sk INNER JOIN call_center AS call_center0 ON catalog_sales0.cs_call_center_sk = call_center0.cc_call_center_sk GROUP BY item0.i_category, item0.i_brand, call_center0.cc_name, t3.d_year, t3.d_moy) AS t5) AS t6 ON t2.i_category = t6.i_category AND t2.i_brand = t6.i_brand AND t2.cc_name = t6.cc_name AND t2.rn = t6.rn + 1 INNER JOIN (SELECT t9.i_category, t9.i_brand, t9.cc_name, t9.d_year, t9.d_moy, t9.sum_sales, (SUM(t9.sum_sales) OVER (PARTITION BY t9.i_category, t9.i_brand, t9.cc_name, t9.d_year RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)) / (COUNT(t9.sum_sales) OVER (PARTITION BY t9.i_category, t9.i_brand, t9.cc_name, t9.d_year RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)) AS avg_monthly_sales, RANK() OVER (PARTITION BY t9.i_category, t9.i_brand, t9.cc_name ORDER BY t9.d_year, t9.d_moy) AS rn FROM (SELECT item1.i_category, item1.i_brand, call_center1.cc_name, t7.d_year, t7.d_moy, SUM(catalog_sales1.cs_sales_price) AS sum_sales FROM item AS item1 INNER JOIN catalog_sales AS catalog_sales1 ON item1.i_item_sk = catalog_sales1.cs_item_sk INNER JOIN (SELECT * FROM date_dim WHERE d_year = 2001 OR d_year = 2001 - 1 AND d_moy = 12 OR d_year = 2001 + 1 AND d_moy = 1) AS t7 ON catalog_sales1.cs_sold_date_sk = t7.d_date_sk INNER JOIN call_center AS call_center1 ON catalog_sales1.cs_call_center_sk = call_center1.cc_call_center_sk GROUP BY item1.i_category, item1.i_brand, call_center1.cc_name, t7.d_year, t7.d_moy) AS t9) AS t10 ON t2.i_category = t10.i_category AND t2.i_brand = t10.i_brand AND t2.cc_name = t10.cc_name AND t2.rn = t10.rn - 1 WHERE t2.d_year = 2001 AND t2.avg_monthly_sales > 0 AND CASE WHEN t2.avg_monthly_sales > 0 THEN ABS(t2.sum_sales - t2.avg_monthly_sales) / t2.avg_monthly_sales > 0.1 ELSE FALSE END ORDER BY t2.sum_sales - t2.avg_monthly_sales, t2.avg_monthly_sales LIMIT 100
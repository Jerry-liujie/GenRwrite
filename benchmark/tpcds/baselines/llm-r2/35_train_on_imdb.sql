SELECT t5.ca_state, t5.cd_gender, t5.cd_marital_status, t5.cd_dep_count, COUNT(*) AS cnt1, AVG(t5.cd_dep_count), STDDEV_SAMP(t5.cd_dep_count), SUM(t5.cd_dep_count), t5.cd_dep_employed_count, COUNT(*) AS cnt2, AVG(t5.cd_dep_employed_count), STDDEV_SAMP(t5.cd_dep_employed_count), SUM(t5.cd_dep_employed_count), t5.cd_dep_college_count, COUNT(*) AS cnt3, AVG(t5.cd_dep_college_count), STDDEV_SAMP(t5.cd_dep_college_count), SUM(t5.cd_dep_college_count) FROM (SELECT t1.c_customer_sk, t1.c_customer_id, t1.c_current_cdemo_sk, t1.c_current_hdemo_sk, t1.c_current_addr_sk, t1.c_first_shipto_date_sk, t1.c_first_sales_date_sk, t1.c_salutation, t1.c_first_name, t1.c_last_name, t1.c_preferred_cust_flag, t1.c_birth_day, t1.c_birth_month, t1.c_birth_year, t1.c_birth_country, t1.c_login, t1.c_email_address, t1.c_last_review_date_sk, t1.ca_address_sk, t1.ca_address_id, t1.ca_street_number, t1.ca_street_name, t1.ca_street_type, t1.ca_suite_number, t1.ca_city, t1.ca_county, t1.ca_state, t1.ca_zip, t1.ca_country, t1.ca_gmt_offset, t1.ca_location_type, t1.cd_demo_sk, t1.cd_gender, t1.cd_marital_status, t1.cd_education_status, t1.cd_purchase_estimate, t1.cd_credit_rating, t1.cd_dep_count, t1.cd_dep_employed_count, t1.cd_dep_college_count, t1.f0, t3.f0 AS f041 FROM (SELECT customer.c_customer_sk, customer.c_customer_id, customer.c_current_cdemo_sk, customer.c_current_hdemo_sk, customer.c_current_addr_sk, customer.c_first_shipto_date_sk, customer.c_first_sales_date_sk, customer.c_salutation, customer.c_first_name, customer.c_last_name, customer.c_preferred_cust_flag, customer.c_birth_day, customer.c_birth_month, customer.c_birth_year, customer.c_birth_country, customer.c_login, customer.c_email_address, customer.c_last_review_date_sk, customer_address.ca_address_sk, customer_address.ca_address_id, customer_address.ca_street_number, customer_address.ca_street_name, customer_address.ca_street_type, customer_address.ca_suite_number, customer_address.ca_city, customer_address.ca_county, customer_address.ca_state, customer_address.ca_zip, customer_address.ca_country, customer_address.ca_gmt_offset, customer_address.ca_location_type, customer_demographics.cd_demo_sk, customer_demographics.cd_gender, customer_demographics.cd_marital_status, customer_demographics.cd_education_status, customer_demographics.cd_purchase_estimate, customer_demographics.cd_credit_rating, customer_demographics.cd_dep_count, customer_demographics.cd_dep_employed_count, customer_demographics.cd_dep_college_count, t0.f0 FROM customer CROSS JOIN customer_address CROSS JOIN customer_demographics LEFT JOIN (SELECT store_sales.ss_customer_sk, TRUE AS f0 FROM store_sales INNER JOIN (SELECT * FROM date_dim WHERE d_year = 1999 AND d_qoy < 4) AS t ON store_sales.ss_sold_date_sk = t.d_date_sk) AS t0 ON customer.c_customer_sk = t0.ss_customer_sk) AS t1 LEFT JOIN (SELECT web_sales.ws_bill_customer_sk, TRUE AS f0 FROM web_sales INNER JOIN (SELECT * FROM date_dim WHERE d_year = 1999 AND d_qoy < 4) AS t2 ON web_sales.ws_sold_date_sk = t2.d_date_sk) AS t3 ON t1.c_customer_sk = t3.ws_bill_customer_sk WHERE t1.c_current_addr_sk = t1.ca_address_sk AND t1.cd_demo_sk = t1.c_current_cdemo_sk AND t1.f0 IS NOT NULL) AS t5 LEFT JOIN (SELECT catalog_sales.cs_ship_customer_sk, TRUE AS f0 FROM catalog_sales INNER JOIN (SELECT * FROM date_dim WHERE d_year = 1999 AND d_qoy < 4) AS t6 ON catalog_sales.cs_sold_date_sk = t6.d_date_sk) AS t7 ON t5.c_customer_sk = t7.cs_ship_customer_sk WHERE t5.f041 IS NOT NULL OR t7.f0 IS NOT NULL GROUP BY t5.ca_state, t5.cd_gender, t5.cd_marital_status, t5.cd_dep_count, t5.cd_dep_employed_count, t5.cd_dep_college_count ORDER BY t5.ca_state, t5.cd_gender, t5.cd_marital_status, t5.cd_dep_count, t5.cd_dep_employed_count, t5.cd_dep_college_count LIMIT 100
SELECT t.i_brand_id AS brand_id, t.i_brand AS brand, t8.t_hour, t8.t_minute, SUM(t7.ext_price) AS ext_price FROM (SELECT * FROM item WHERE i_manager_id = 1) AS t INNER JOIN (SELECT * FROM (SELECT web_sales.ws_ext_sales_price AS ext_price, web_sales.ws_sold_date_sk AS sold_date_sk, web_sales.ws_item_sk AS sold_item_sk, web_sales.ws_sold_time_sk AS time_sk FROM web_sales INNER JOIN (SELECT * FROM date_dim WHERE d_moy = 12 AND d_year = 2002) AS t0 ON web_sales.ws_sold_date_sk = t0.d_date_sk UNION ALL SELECT catalog_sales.cs_ext_sales_price AS ext_price, catalog_sales.cs_sold_date_sk AS sold_date_sk, catalog_sales.cs_item_sk AS sold_item_sk, catalog_sales.cs_sold_time_sk AS time_sk FROM catalog_sales INNER JOIN (SELECT * FROM date_dim WHERE d_moy = 12 AND d_year = 2002) AS t2 ON catalog_sales.cs_sold_date_sk = t2.d_date_sk) AS t UNION ALL SELECT store_sales.ss_ext_sales_price AS ext_price, store_sales.ss_sold_date_sk AS sold_date_sk, store_sales.ss_item_sk AS sold_item_sk, store_sales.ss_sold_time_sk AS time_sk FROM store_sales INNER JOIN (SELECT * FROM date_dim WHERE d_moy = 12 AND d_year = 2002) AS t5 ON store_sales.ss_sold_date_sk = t5.d_date_sk) AS t7 ON t.i_item_sk = t7.sold_item_sk INNER JOIN (SELECT * FROM time_dim WHERE t_meal_time = 'breakfast' OR t_meal_time = 'dinner') AS t8 ON t7.time_sk = t8.t_time_sk GROUP BY t.i_brand, t.i_brand_id, t8.t_hour, t8.t_minute ORDER BY SUM(t7.ext_price) DESC, t.i_brand_id
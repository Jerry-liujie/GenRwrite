SELECT COUNT(t7.ws_order_number) FILTER (WHERE t7.g_0) AS "order count", MIN(t7."total shipping cost") FILTER (WHERE t7.g_1) AS "total shipping cost", MIN(t7."total net profit") FILTER (WHERE t7.g_1) AS "total net profit" FROM (SELECT t2.ws_order_number, SUM(t2.ws_ext_ship_cost) AS "total shipping cost", SUM(t2.ws_net_profit) AS "total net profit", GROUPING(t2.ws_order_number) = 0 AS g_0, GROUPING(t2.ws_order_number) = 1 AS g_1 FROM (SELECT * FROM (SELECT web_sales.ws_sold_date_sk, web_sales.ws_sold_time_sk, web_sales.ws_ship_date_sk, web_sales.ws_item_sk, web_sales.ws_bill_customer_sk, web_sales.ws_bill_cdemo_sk, web_sales.ws_bill_hdemo_sk, web_sales.ws_bill_addr_sk, web_sales.ws_ship_customer_sk, web_sales.ws_ship_cdemo_sk, web_sales.ws_ship_hdemo_sk, web_sales.ws_ship_addr_sk, web_sales.ws_web_page_sk, web_sales.ws_web_site_sk, web_sales.ws_ship_mode_sk, web_sales.ws_warehouse_sk, web_sales.ws_promo_sk, web_sales.ws_order_number, web_sales.ws_quantity, web_sales.ws_wholesale_cost, web_sales.ws_list_price, web_sales.ws_sales_price, web_sales.ws_ext_discount_amt, web_sales.ws_ext_sales_price, web_sales.ws_ext_wholesale_cost, web_sales.ws_ext_list_price, web_sales.ws_ext_tax, web_sales.ws_coupon_amt, web_sales.ws_ext_ship_cost, web_sales.ws_net_paid, web_sales.ws_net_paid_inc_tax, web_sales.ws_net_paid_inc_ship, web_sales.ws_net_paid_inc_ship_tax, web_sales.ws_net_profit, date_dim.d_date_sk, date_dim.d_date_id, date_dim.d_date, date_dim.d_month_seq, date_dim.d_week_seq, date_dim.d_quarter_seq, date_dim.d_year, date_dim.d_dow, date_dim.d_moy, date_dim.d_dom, date_dim.d_qoy, date_dim.d_fy_year, date_dim.d_fy_quarter_seq, date_dim.d_fy_week_seq, date_dim.d_day_name, date_dim.d_quarter_name, date_dim.d_holiday, date_dim.d_weekend, date_dim.d_following_holiday, date_dim.d_first_dom, date_dim.d_last_dom, date_dim.d_same_day_ly, date_dim.d_same_day_lq, date_dim.d_current_day, date_dim.d_current_week, date_dim.d_current_month, date_dim.d_current_quarter, date_dim.d_current_year, customer_address.ca_address_sk, customer_address.ca_address_id, customer_address.ca_street_number, customer_address.ca_street_name, customer_address.ca_street_type, customer_address.ca_suite_number, customer_address.ca_city, customer_address.ca_county, customer_address.ca_state, customer_address.ca_zip, customer_address.ca_country, customer_address.ca_gmt_offset, customer_address.ca_location_type, web_site.web_site_sk, web_site.web_site_id, web_site.web_rec_start_date, web_site.web_rec_end_date, web_site.web_name, web_site.web_open_date_sk, web_site.web_close_date_sk, web_site.web_class, web_site.web_manager, web_site.web_mkt_id, web_site.web_mkt_class, web_site.web_mkt_desc, web_site.web_market_manager, web_site.web_company_id, web_site.web_company_name, web_site.web_street_number, web_site.web_street_name, web_site.web_street_type, web_site.web_suite_number, web_site.web_city, web_site.web_county, web_site.web_state, web_site.web_zip, web_site.web_country, web_site.web_gmt_offset, web_site.web_tax_percentage, t0.f0 FROM web_sales CROSS JOIN date_dim CROSS JOIN customer_address CROSS JOIN web_site LEFT JOIN (SELECT t.ws_warehouse_sk AS ws_warehouse_sk0, t.ws_order_number AS ws_order_number0, TRUE AS f0 FROM web_sales AS web_sales0 INNER JOIN (SELECT web_sales1.ws_warehouse_sk, web_sales1.ws_order_number FROM web_sales AS web_sales1, date_dim AS date_dim0, customer_address AS customer_address0, web_site AS web_site0) AS t ON web_sales0.ws_order_number = t.ws_order_number AND t.ws_warehouse_sk <> web_sales0.ws_warehouse_sk) AS t0 ON web_sales.ws_warehouse_sk = t0.ws_warehouse_sk0 AND web_sales.ws_order_number = t0.ws_order_number0) AS t1 WHERE t1.d_date >= DATE '2002-05-01' AND t1.d_date <= (DATE '2002-05-01' + INTERVAL '60' DAY) AND (t1.ws_ship_date_sk = t1.d_date_sk AND t1.ws_ship_addr_sk = t1.ca_address_sk) AND (t1.ca_state = 'OK' AND t1.ws_web_site_sk = t1.web_site_sk AND (t1.web_company_name = 'pri' AND t1.f0 IS NOT NULL))) AS t2 LEFT JOIN (SELECT wr_order_number, TRUE AS f0 FROM web_returns) AS t3 ON t2.ws_order_number = t3.wr_order_number WHERE t3.f0 IS NULL GROUP BY ROLLUP(t2.ws_order_number)) AS t7 ORDER BY COUNT(t7.ws_order_number) FILTER (WHERE t7.g_0) LIMIT 100
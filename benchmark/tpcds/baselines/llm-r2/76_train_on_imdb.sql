SELECT channel, col_name, d_year, d_qoy, i_category, COUNT(*) AS sales_cnt, SUM(ext_sales_price) AS sales_amt FROM (SELECT * FROM (SELECT 'store' AS channel, 'ss_customer_sk' AS col_name, date_dim.d_year, date_dim.d_qoy, item.i_category, store_sales.ss_ext_sales_price AS ext_sales_price FROM store_sales, item, date_dim WHERE store_sales.ss_customer_sk IS NULL AND store_sales.ss_sold_date_sk = date_dim.d_date_sk AND store_sales.ss_item_sk = item.i_item_sk UNION ALL SELECT 'web' AS channel, 'ws_promo_sk' AS col_name, date_dim0.d_year, date_dim0.d_qoy, item0.i_category, web_sales.ws_ext_sales_price AS ext_sales_price FROM web_sales, item AS item0, date_dim AS date_dim0 WHERE web_sales.ws_promo_sk IS NULL AND web_sales.ws_sold_date_sk = date_dim0.d_date_sk AND web_sales.ws_item_sk = item0.i_item_sk) AS t UNION ALL SELECT 'catalog' AS channel, 'cs_bill_customer_sk' AS col_name, date_dim1.d_year, date_dim1.d_qoy, item1.i_category, catalog_sales.cs_ext_sales_price AS ext_sales_price FROM catalog_sales, item AS item1, date_dim AS date_dim1 WHERE catalog_sales.cs_bill_customer_sk IS NULL AND catalog_sales.cs_sold_date_sk = date_dim1.d_date_sk AND catalog_sales.cs_item_sk = item1.i_item_sk) AS t6 GROUP BY channel, col_name, d_year, d_qoy, i_category ORDER BY channel, col_name, d_year, d_qoy, i_category LIMIT 100
SELECT * FROM (SELECT t1.i_manager_id, t1.sum_sales, (SUM(t1.sum_sales) OVER (PARTITION BY t1.i_manager_id RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)) / (COUNT(t1.sum_sales) OVER (PARTITION BY t1.i_manager_id RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)) AS avg_monthly_sales FROM (SELECT item.i_manager_id, date_dim.d_moy, SUM(store_sales.ss_sales_price) AS sum_sales FROM item, store_sales, date_dim, store WHERE store_sales.ss_item_sk = item.i_item_sk AND store_sales.ss_sold_date_sk = date_dim.d_date_sk AND store_sales.ss_store_sk = store.s_store_sk AND (date_dim.d_month_seq = 1222 OR (date_dim.d_month_seq = 1222 + 1 OR date_dim.d_month_seq = 1222 + 2) OR (date_dim.d_month_seq = 1222 + 3 OR (date_dim.d_month_seq = 1222 + 4 OR date_dim.d_month_seq = 1222 + 5)) OR (date_dim.d_month_seq = 1222 + 6 OR (date_dim.d_month_seq = 1222 + 7 OR date_dim.d_month_seq = 1222 + 8) OR (date_dim.d_month_seq = 1222 + 9 OR (date_dim.d_month_seq = 1222 + 10 OR date_dim.d_month_seq = 1222 + 11)))) AND ((item.i_category = 'Books' OR item.i_category = 'Children' OR item.i_category = 'Electronics') AND (item.i_class = 'personal' OR item.i_class = 'portable' OR item.i_class = 'reference' OR item.i_class = 'self-help') AND (item.i_brand = 'scholaramalgamalg #14' OR item.i_brand = 'scholaramalgamalg #7' OR item.i_brand = 'exportiunivamalg #9' OR item.i_brand = 'scholaramalgamalg #9') OR (item.i_category = 'Women' OR item.i_category = 'Music' OR item.i_category = 'Men') AND (item.i_class = 'accessories' OR item.i_class = 'classical' OR item.i_class = 'fragrances' OR item.i_class = 'pants') AND (item.i_brand = 'amalgimporto #1' OR item.i_brand = 'edu packscholar #1' OR item.i_brand = 'exportiimporto #1' OR item.i_brand = 'importoamalg #1')) GROUP BY item.i_manager_id, date_dim.d_moy) AS t1) AS t2 WHERE CASE WHEN avg_monthly_sales > 0 THEN CAST(ABS(sum_sales - avg_monthly_sales) / avg_monthly_sales AS DECIMAL(19, 0)) ELSE NULL END > 0.1 ORDER BY i_manager_id, avg_monthly_sales, sum_sales LIMIT 100
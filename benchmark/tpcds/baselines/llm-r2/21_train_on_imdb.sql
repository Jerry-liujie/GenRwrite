SELECT warehouse.w_warehouse_name, t.i_item_id, SUM(CASE WHEN t0.d_date < DATE '1999-06-22' THEN inventory.inv_quantity_on_hand ELSE 0 END) AS inv_before, SUM(CASE WHEN t0.d_date >= DATE '1999-06-22' THEN inventory.inv_quantity_on_hand ELSE 0 END) AS inv_after FROM inventory INNER JOIN warehouse ON inventory.inv_warehouse_sk = warehouse.w_warehouse_sk INNER JOIN (SELECT * FROM item WHERE i_current_price >= 0.99 AND i_current_price <= 1.49) AS t ON inventory.inv_item_sk = t.i_item_sk INNER JOIN (SELECT * FROM date_dim WHERE d_date >= (DATE '1999-06-22' - INTERVAL '30' DAY) AND d_date <= (DATE '1999-06-22' + INTERVAL '30' DAY)) AS t0 ON inventory.inv_date_sk = t0.d_date_sk GROUP BY warehouse.w_warehouse_name, t.i_item_id HAVING CASE WHEN SUM(CASE WHEN t0.d_date < DATE '1999-06-22' THEN inventory.inv_quantity_on_hand ELSE 0 END) > 0 THEN SUM(CASE WHEN t0.d_date >= DATE '1999-06-22' THEN inventory.inv_quantity_on_hand ELSE 0 END) / SUM(CASE WHEN t0.d_date < DATE '1999-06-22' THEN inventory.inv_quantity_on_hand ELSE 0 END) >= 2.0 / 3.0 ELSE FALSE END AND CASE WHEN SUM(CASE WHEN t0.d_date < DATE '1999-06-22' THEN inventory.inv_quantity_on_hand ELSE 0 END) > 0 THEN SUM(CASE WHEN t0.d_date >= DATE '1999-06-22' THEN inventory.inv_quantity_on_hand ELSE 0 END) / SUM(CASE WHEN t0.d_date < DATE '1999-06-22' THEN inventory.inv_quantity_on_hand ELSE 0 END) <= 3.0 / 2.0 ELSE FALSE END ORDER BY warehouse.w_warehouse_name, t.i_item_id LIMIT 100
SELECT t9.rnk, item.i_product_name AS best_performing, item0.i_product_name AS worst_performing FROM (SELECT * FROM (SELECT t1.item_sk, RANK() OVER (ORDER BY t1.rank_col) AS rnk FROM (SELECT ss_item_sk AS item_sk, AVG(ss_net_profit) AS rank_col FROM store_sales WHERE ss_store_sk = 4 GROUP BY ss_item_sk) AS t1 LEFT JOIN (SELECT AVG(ss_net_profit) AS rank_col FROM store_sales WHERE ss_store_sk = 4 AND ss_hdemo_sk IS NULL GROUP BY ss_store_sk) AS t5 ON TRUE WHERE t1.rank_col > 0.9 * t5.rank_col) AS t7 WHERE t7.rnk < 11) AS t9, (SELECT * FROM (SELECT t12.item_sk, RANK() OVER (ORDER BY t12.rank_col DESC) AS rnk FROM (SELECT ss_item_sk AS item_sk, AVG(ss_net_profit) AS rank_col FROM store_sales WHERE ss_store_sk = 4 GROUP BY ss_item_sk) AS t12 LEFT JOIN (SELECT AVG(ss_net_profit) AS rank_col FROM store_sales WHERE ss_store_sk = 4 AND ss_hdemo_sk IS NULL GROUP BY ss_store_sk) AS t16 ON TRUE WHERE t12.rank_col > 0.9 * t16.rank_col) AS t18 WHERE t18.rnk < 11) AS t20, item, item AS item0 WHERE t9.rnk = t20.rnk AND item.i_item_sk = t9.item_sk AND item0.i_item_sk = t20.item_sk ORDER BY t9.rnk LIMIT 100
SELECT t1.i_item_id, t1.i_item_desc, t1.i_category, t1.i_class, t1.i_current_price, t1.itemrevenue, t1.itemrevenue * 100 / (SUM(t1.itemrevenue) OVER (PARTITION BY t1.i_class RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)) AS revenueratio FROM (SELECT item.i_item_id, item.i_item_desc, item.i_category, item.i_class, item.i_current_price, SUM(web_sales.ws_ext_sales_price) AS itemrevenue FROM web_sales, item, date_dim WHERE web_sales.ws_item_sk = item.i_item_sk AND (item.i_category = 'Men' OR item.i_category = 'Books' OR item.i_category = 'Electronics') AND web_sales.ws_sold_date_sk = date_dim.d_date_sk AND date_dim.d_date >= '2001-06-15' AND date_dim.d_date <= (CAST('2001-06-15' AS DATE) + INTERVAL '30' DAY) GROUP BY item.i_item_id, item.i_item_desc, item.i_current_price, item.i_class, item.i_category) AS t1 ORDER BY t1.i_category, t1.i_class, t1.i_item_id, t1.i_item_desc, t1.itemrevenue * 100 / (SUM(t1.itemrevenue) OVER (PARTITION BY t1.i_class RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)) LIMIT 100
SELECT t5.product_name, t5.store_name, t5.store_zip, t5.b_street_number, t5.b_street_name, t5.b_city, t5.b_zip, t5.c_street_number, t5.c_street_name, t5.c_city, t5.c_zip, t5.syear, t5.cnt, t5.s1 AS s11, t5.s2 AS s21, t5.s3 AS s31, t12.s1 AS s12, t12.s2 AS s22, t12.s3 AS s32, t12.syear AS syear0, t12.cnt AS cnt0 FROM (SELECT t2.i_product_name AS product_name, t2.i_item_sk AS item_sk, store.s_store_name AS store_name, store.s_zip AS store_zip, customer_address.ca_street_number AS b_street_number, customer_address.ca_street_name AS b_street_name, customer_address.ca_city AS b_city, customer_address.ca_zip AS b_zip, customer_address0.ca_street_number AS c_street_number, customer_address0.ca_street_name AS c_street_name, customer_address0.ca_city AS c_city, customer_address0.ca_zip AS c_zip, date_dim.d_year AS syear, date_dim0.d_year AS fsyear, date_dim1.d_year AS s2year, COUNT(*) AS cnt, SUM(store_sales.ss_wholesale_cost) AS s1, SUM(store_sales.ss_list_price) AS s2, SUM(store_sales.ss_coupon_amt) AS s3 FROM store_sales INNER JOIN store_returns ON store_sales.ss_item_sk = store_returns.sr_item_sk AND store_sales.ss_ticket_number = store_returns.sr_ticket_number INNER JOIN (SELECT catalog_sales.cs_item_sk, SUM(catalog_sales.cs_ext_list_price) AS sale, SUM(catalog_returns.cr_refunded_cash + catalog_returns.cr_reversed_charge + catalog_returns.cr_store_credit) AS refund FROM catalog_sales INNER JOIN catalog_returns ON catalog_sales.cs_item_sk = catalog_returns.cr_item_sk AND catalog_sales.cs_order_number = catalog_returns.cr_order_number GROUP BY catalog_sales.cs_item_sk HAVING SUM(catalog_sales.cs_ext_list_price) > 2 * SUM(catalog_returns.cr_refunded_cash + catalog_returns.cr_reversed_charge + catalog_returns.cr_store_credit)) AS t1 ON store_sales.ss_item_sk = t1.cs_item_sk INNER JOIN date_dim ON store_sales.ss_sold_date_sk = date_dim.d_date_sk CROSS JOIN date_dim AS date_dim0 CROSS JOIN date_dim AS date_dim1 INNER JOIN store ON store_sales.ss_store_sk = store.s_store_sk INNER JOIN customer ON store_sales.ss_customer_sk = customer.c_customer_sk AND date_dim0.d_date_sk = customer.c_first_sales_date_sk AND date_dim1.d_date_sk = customer.c_first_shipto_date_sk INNER JOIN customer_demographics ON store_sales.ss_cdemo_sk = customer_demographics.cd_demo_sk INNER JOIN customer_demographics AS customer_demographics0 ON customer.c_current_cdemo_sk = customer_demographics0.cd_demo_sk AND customer_demographics.cd_marital_status <> customer_demographics0.cd_marital_status INNER JOIN promotion ON store_sales.ss_promo_sk = promotion.p_promo_sk INNER JOIN household_demographics ON store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk INNER JOIN household_demographics AS household_demographics0 ON customer.c_current_hdemo_sk = household_demographics0.hd_demo_sk INNER JOIN customer_address ON store_sales.ss_addr_sk = customer_address.ca_address_sk INNER JOIN customer_address AS customer_address0 ON customer.c_current_addr_sk = customer_address0.ca_address_sk INNER JOIN income_band ON household_demographics.hd_income_band_sk = income_band.ib_income_band_sk INNER JOIN income_band AS income_band0 ON household_demographics0.hd_income_band_sk = income_band0.ib_income_band_sk INNER JOIN (SELECT * FROM item WHERE i_color IN ('blush', 'lace', 'lawn', 'misty', 'orange', 'pink') AND i_current_price >= 48 AND i_current_price <= 48 + 10 AND i_current_price >= 48 + 1 AND i_current_price <= 48 + 15) AS t2 ON store_sales.ss_item_sk = t2.i_item_sk GROUP BY t2.i_product_name, t2.i_item_sk, store.s_store_name, store.s_zip, customer_address.ca_street_number, customer_address.ca_street_name, customer_address.ca_city, customer_address.ca_zip, customer_address0.ca_street_number, customer_address0.ca_street_name, customer_address0.ca_city, customer_address0.ca_zip, date_dim.d_year, date_dim0.d_year, date_dim1.d_year HAVING date_dim.d_year = 1999) AS t5 INNER JOIN (SELECT t9.i_product_name AS product_name, t9.i_item_sk AS item_sk, store0.s_store_name AS store_name, store0.s_zip AS store_zip, customer_address1.ca_street_number AS b_street_number, customer_address1.ca_street_name AS b_street_name, customer_address1.ca_city AS b_city, customer_address1.ca_zip AS b_zip, customer_address2.ca_street_number AS c_street_number, customer_address2.ca_street_name AS c_street_name, customer_address2.ca_city AS c_city, customer_address2.ca_zip AS c_zip, date_dim2.d_year AS syear, date_dim3.d_year AS fsyear, date_dim4.d_year AS s2year, COUNT(*) AS cnt, SUM(store_sales0.ss_wholesale_cost) AS s1, SUM(store_sales0.ss_list_price) AS s2, SUM(store_sales0.ss_coupon_amt) AS s3 FROM store_sales AS store_sales0 INNER JOIN store_returns AS store_returns0 ON store_sales0.ss_item_sk = store_returns0.sr_item_sk AND store_sales0.ss_ticket_number = store_returns0.sr_ticket_number INNER JOIN (SELECT catalog_sales0.cs_item_sk, SUM(catalog_sales0.cs_ext_list_price) AS sale, SUM(catalog_returns0.cr_refunded_cash + catalog_returns0.cr_reversed_charge + catalog_returns0.cr_store_credit) AS refund FROM catalog_sales AS catalog_sales0 INNER JOIN catalog_returns AS catalog_returns0 ON catalog_sales0.cs_item_sk = catalog_returns0.cr_item_sk AND catalog_sales0.cs_order_number = catalog_returns0.cr_order_number GROUP BY catalog_sales0.cs_item_sk HAVING SUM(catalog_sales0.cs_ext_list_price) > 2 * SUM(catalog_returns0.cr_refunded_cash + catalog_returns0.cr_reversed_charge + catalog_returns0.cr_store_credit)) AS t8 ON store_sales0.ss_item_sk = t8.cs_item_sk INNER JOIN date_dim AS date_dim2 ON store_sales0.ss_sold_date_sk = date_dim2.d_date_sk CROSS JOIN date_dim AS date_dim3 CROSS JOIN date_dim AS date_dim4 INNER JOIN store AS store0 ON store_sales0.ss_store_sk = store0.s_store_sk INNER JOIN customer AS customer0 ON store_sales0.ss_customer_sk = customer0.c_customer_sk AND date_dim3.d_date_sk = customer0.c_first_sales_date_sk AND date_dim4.d_date_sk = customer0.c_first_shipto_date_sk INNER JOIN customer_demographics AS customer_demographics1 ON store_sales0.ss_cdemo_sk = customer_demographics1.cd_demo_sk INNER JOIN customer_demographics AS customer_demographics2 ON customer0.c_current_cdemo_sk = customer_demographics2.cd_demo_sk AND customer_demographics1.cd_marital_status <> customer_demographics2.cd_marital_status INNER JOIN promotion AS promotion0 ON store_sales0.ss_promo_sk = promotion0.p_promo_sk INNER JOIN household_demographics AS household_demographics1 ON store_sales0.ss_hdemo_sk = household_demographics1.hd_demo_sk INNER JOIN household_demographics AS household_demographics2 ON customer0.c_current_hdemo_sk = household_demographics2.hd_demo_sk INNER JOIN customer_address AS customer_address1 ON store_sales0.ss_addr_sk = customer_address1.ca_address_sk INNER JOIN customer_address AS customer_address2 ON customer0.c_current_addr_sk = customer_address2.ca_address_sk INNER JOIN income_band AS income_band1 ON household_demographics1.hd_income_band_sk = income_band1.ib_income_band_sk INNER JOIN income_band AS income_band2 ON household_demographics2.hd_income_band_sk = income_band2.ib_income_band_sk INNER JOIN (SELECT * FROM item WHERE i_color IN ('blush', 'lace', 'lawn', 'misty', 'orange', 'pink') AND i_current_price >= 48 AND i_current_price <= 48 + 10 AND i_current_price >= 48 + 1 AND i_current_price <= 48 + 15) AS t9 ON store_sales0.ss_item_sk = t9.i_item_sk GROUP BY t9.i_product_name, t9.i_item_sk, store0.s_store_name, store0.s_zip, customer_address1.ca_street_number, customer_address1.ca_street_name, customer_address1.ca_city, customer_address1.ca_zip, customer_address2.ca_street_number, customer_address2.ca_street_name, customer_address2.ca_city, customer_address2.ca_zip, date_dim2.d_year, date_dim3.d_year, date_dim4.d_year HAVING date_dim2.d_year = 1999 + 1) AS t12 ON t5.item_sk = t12.item_sk AND t5.cnt >= t12.cnt AND t5.store_name = t12.store_name AND t5.store_zip = t12.store_zip ORDER BY t5.product_name, t5.store_name, t12.cnt, t5.s1, t12.s1
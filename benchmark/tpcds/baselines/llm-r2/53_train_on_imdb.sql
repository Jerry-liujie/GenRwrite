SELECT * FROM (SELECT item.i_manufact_id, SUM(store_sales.ss_sales_price) AS sum_sales, (SUM(SUM(store_sales.ss_sales_price)) OVER (PARTITION BY item.i_manufact_id RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)) / (COUNT(SUM(store_sales.ss_sales_price)) OVER (PARTITION BY item.i_manufact_id RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)) AS avg_quarterly_sales FROM item, store_sales, date_dim, store WHERE store_sales.ss_item_sk = item.i_item_sk AND store_sales.ss_sold_date_sk = date_dim.d_date_sk AND store_sales.ss_store_sk = store.s_store_sk AND (date_dim.d_month_seq = 1186 OR (date_dim.d_month_seq = 1186 + 1 OR date_dim.d_month_seq = 1186 + 2) OR (date_dim.d_month_seq = 1186 + 3 OR (date_dim.d_month_seq = 1186 + 4 OR date_dim.d_month_seq = 1186 + 5)) OR (date_dim.d_month_seq = 1186 + 6 OR (date_dim.d_month_seq = 1186 + 7 OR date_dim.d_month_seq = 1186 + 8) OR (date_dim.d_month_seq = 1186 + 9 OR (date_dim.d_month_seq = 1186 + 10 OR date_dim.d_month_seq = 1186 + 11)))) AND (item.i_category IN ('Books', 'Children', 'Electronics') AND item.i_class IN ('personal', 'portable', 'reference', 'self-help') AND item.i_brand IN ('exportiunivamalg #9', 'scholaramalgamalg #14', 'scholaramalgamalg #7', 'scholaramalgamalg #9') OR item.i_category IN ('Men', 'Music', 'Women') AND item.i_class IN ('accessories', 'classical', 'fragrances', 'pants') AND item.i_brand IN ('amalgimporto #1', 'edu packscholar #1', 'exportiimporto #1', 'importoamalg #1')) GROUP BY item.i_manufact_id, date_dim.d_qoy) AS t1 WHERE CASE WHEN t1.avg_quarterly_sales > 0 THEN ABS(t1.sum_sales - t1.avg_quarterly_sales) / t1.avg_quarterly_sales > 0.1 ELSE FALSE END ORDER BY avg_quarterly_sales, sum_sales, i_manufact_id LIMIT 100
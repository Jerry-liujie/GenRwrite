SELECT customer.c_last_name, customer.c_first_name, customer_address0.ca_city, t4.bought_city, t4.ss_ticket_number, t4.extended_price, t4.extended_tax, t4.list_price FROM (SELECT store_sales.ss_ticket_number, store_sales.ss_customer_sk, customer_address.ca_city AS bought_city, SUM(store_sales.ss_ext_sales_price) AS extended_price, SUM(store_sales.ss_ext_list_price) AS list_price, SUM(store_sales.ss_ext_tax) AS extended_tax FROM store_sales INNER JOIN (SELECT * FROM date_dim WHERE d_dom >= 1 AND d_dom <= 2 AND (d_year = 1998 OR d_year = 1998 + 1 OR d_year = 1998 + 2)) AS t ON store_sales.ss_sold_date_sk = t.d_date_sk INNER JOIN (SELECT * FROM store WHERE s_city IN ('Fairview', 'Midway')) AS t0 ON store_sales.ss_store_sk = t0.s_store_sk INNER JOIN (SELECT * FROM household_demographics WHERE hd_dep_count = 3 OR hd_vehicle_count = 4) AS t1 ON store_sales.ss_hdemo_sk = t1.hd_demo_sk INNER JOIN customer_address ON store_sales.ss_addr_sk = customer_address.ca_address_sk GROUP BY store_sales.ss_ticket_number, store_sales.ss_customer_sk, store_sales.ss_addr_sk, customer_address.ca_city) AS t4 INNER JOIN customer ON t4.ss_customer_sk = customer.c_customer_sk INNER JOIN customer_address AS customer_address0 ON customer.c_current_addr_sk = customer_address0.ca_address_sk AND customer_address0.ca_city <> t4.bought_city ORDER BY customer.c_last_name, t4.ss_ticket_number LIMIT 100
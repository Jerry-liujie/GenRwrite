Push filtering of date ranges into a separate CTE: Limits the data processed in the joins, thereby reducing overall dataset size.
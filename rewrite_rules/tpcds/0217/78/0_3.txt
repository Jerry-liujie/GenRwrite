Pre-aggregate and filter within common table expressions: Lowers the amount of data processed in later stages.
Maintain window function calculation at the source level: Ensures proper partitioning and ordering without re-computation outside the analytic function.
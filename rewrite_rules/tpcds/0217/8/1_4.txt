Compute derived columns (such as substring values) once in the CTE: Avoids redundant calculations during join processing.
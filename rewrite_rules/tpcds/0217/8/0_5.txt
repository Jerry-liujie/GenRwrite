Push filtering conditions into the CTEs and join clauses: Narrows the dataset early, reducing processing time during aggregation.
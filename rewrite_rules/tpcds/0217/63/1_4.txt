Use a common table expression (CTE) to isolate the aggregation logic: Enhances modularity and easier readability while potentially aiding optimization.
Compute both ranking orders (ascending and descending) in one pass: Avoids scanning the same data multiple times.
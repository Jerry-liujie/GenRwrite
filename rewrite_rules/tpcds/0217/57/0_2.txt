Replace self-joins with window functions (lag/lead): Eliminates additional join overhead and simplifies the query plan.
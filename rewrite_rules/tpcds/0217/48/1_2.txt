Factor out common filtering conditions into a WITH (CTE) clause: Reduces redundant computations by processing shared predicates once.
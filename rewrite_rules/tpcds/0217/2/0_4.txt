Create distinct aggregated subqueries for different periods: Simplifies the final join logic and minimizes repeated computation.
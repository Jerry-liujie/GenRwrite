Compute aggregates in common table expressions prior to joining: Enables early filtering and minimizes data volume in subsequent joins.
[{"Plan": {"Node Type": "Limit", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 1436676.28, "Total Cost": 1436676.29, "Plan Rows": 1, "Plan Width": 480, "Actual Startup Time": 1461707.294, "Actual Total Time": 1461716.186, "Actual Rows": 95, "Actual Loops": 1, "Plans": [{"Node Type": "Append", "Parent Relationship": "InitPlan", "Subplan Name": "CTE year_total", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 421099.22, "Total Cost": 1084980.31, "Plan Rows": 3349208, "Plan Width": 255, "Actual Startup Time": 4364.48, "Actual Total Time": 7140.884, "Actual Rows": 247230, "Actual Loops": 1, "Subplans Removed": 0, "Plans": [{"Node Type": "Aggregate", "Strategy": "Sorted", "Partial Mode": "Finalize", "Parent Relationship": "Member", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 421099.22, "Total Cost": 805640.93, "Plan Rows": 2630472, "Plan Width": 255, "Actual Startup Time": 4364.479, "Actual Total Time": 5685.414, "Actual Rows": 190581, "Actual Loops": 1, "Group Key": ["customer.c_customer_id", "customer.c_first_name", "customer.c_last_name", "customer.c_preferred_cust_flag", "customer.c_birth_country", "customer.c_login", "customer.c_email_address", "date_dim.d_year"], "Plans": [{"Node Type": "Gather Merge", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 421099.22, "Total Cost": 717958.53, "Plan Rows": 2192060, "Plan Width": 223, "Actual Startup Time": 4364.468, "Actual Total Time": 5584.888, "Actual Rows": 196414, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Plans": [{"Node Type": "Aggregate", "Strategy": "Sorted", "Partial Mode": "Partial", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 420099.19, "Total Cost": 463940.39, "Plan Rows": 1096030, "Plan Width": 223, "Actual Startup Time": 4344.235, "Actual Total Time": 5351.771, "Actual Rows": 65471, "Actual Loops": 3, "Group Key": ["customer.c_customer_id", "customer.c_first_name", "customer.c_last_name", "customer.c_preferred_cust_flag", "customer.c_birth_country", "customer.c_login", "customer.c_email_address", "date_dim.d_year"], "Workers": [], "Plans": [{"Node Type": "Sort", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 420099.19, "Total Cost": 422839.27, "Plan Rows": 1096030, "Plan Width": 201, "Actual Startup Time": 4344.205, "Actual Total Time": 5083.436, "Actual Rows": 895151, "Actual Loops": 3, "Sort Key": ["customer.c_customer_id", "customer.c_first_name", "customer.c_last_name", "customer.c_preferred_cust_flag", "customer.c_birth_country", "customer.c_login", "customer.c_email_address", "date_dim.d_year"], "Sort Method": "external merge", "Sort Space Used": 144000, "Sort Space Type": "Disk", "Workers": [{"Worker Number": 0, "Sort Method": "external merge", "Sort Space Used": 141888, "Sort Space Type": "Disk"}, {"Worker Number": 1, "Sort Method": "external merge", "Sort Space Used": 139896, "Sort Space Type": "Disk"}], "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 8015.36, "Total Cost": 92866.25, "Plan Rows": 1096030, "Plan Width": 201, "Actual Startup Time": 357.028, "Actual Total Time": 503.412, "Actual Rows": 895151, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(store_sales.ss_customer_sk = customer.c_customer_sk)", "Workers": [], "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 2371.82, "Total Cost": 69220.05, "Plan Rows": 1146875, "Plan Width": 18, "Actual Startup Time": 4.895, "Actual Total Time": 220.596, "Actual Rows": 916770, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(store_sales.ss_sold_date_sk = date_dim.d_date_sk)", "Workers": [], "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Async Capable": false, "Relation Name": "store_sales", "Alias": "store_sales", "Startup Cost": 0.0, "Total Cost": 63697.62, "Plan Rows": 1200162, "Plan Width": 18, "Actual Startup Time": 0.035, "Actual Total Time": 71.686, "Actual Rows": 960135, "Actual Loops": 3, "Workers": []}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Async Capable": false, "Startup Cost": 1834.7, "Total Cost": 1834.7, "Plan Rows": 42970, "Plan Width": 8, "Actual Startup Time": 4.772, "Actual Total Time": 4.772, "Actual Rows": 24350, "Actual Loops": 3, "Hash Buckets": 131072, "Original Hash Buckets": 131072, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 3904, "Workers": [], "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Async Capable": false, "Relation Name": "date_dim", "Alias": "date_dim", "Startup Cost": 0.0, "Total Cost": 1834.7, "Plan Rows": 42970, "Plan Width": 8, "Actual Startup Time": 0.005, "Actual Total Time": 1.967, "Actual Rows": 24350, "Actual Loops": 3, "Workers": []}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Async Capable": false, "Startup Cost": 3356.24, "Total Cost": 3356.24, "Plan Rows": 58824, "Plan Width": 191, "Actual Startup Time": 17.676, "Actual Total Time": 17.676, "Actual Rows": 33333, "Actual Loops": 3, "Hash Buckets": 32768, "Original Hash Buckets": 32768, "Hash Batches": 8, "Original Hash Batches": 8, "Peak Memory Usage": 2368, "Workers": [], "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Async Capable": false, "Relation Name": "customer", "Alias": "customer", "Startup Cost": 0.0, "Total Cost": 3356.24, "Plan Rows": 58824, "Plan Width": 191, "Actual Startup Time": 0.015, "Actual Total Time": 7.705, "Actual Rows": 33333, "Actual Loops": 3, "Workers": []}]}]}]}]}]}]}, {"Node Type": "Aggregate", "Strategy": "Sorted", "Partial Mode": "Finalize", "Parent Relationship": "Member", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 124031.26, "Total Cost": 229101.26, "Plan Rows": 718736, "Plan Width": 255, "Actual Startup Time": 1016.654, "Actual Total Time": 1446.769, "Actual Rows": 56649, "Actual Loops": 1, "Group Key": ["customer_1.c_customer_id", "customer_1.c_first_name", "customer_1.c_last_name", "customer_1.c_preferred_cust_flag", "customer_1.c_birth_country", "customer_1.c_login", "customer_1.c_email_address", "date_dim_1.d_year"], "Plans": [{"Node Type": "Gather Merge", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 124031.26, "Total Cost": 205143.41, "Plan Rows": 598946, "Plan Width": 223, "Actual Startup Time": 1016.646, "Actual Total Time": 1417.211, "Actual Rows": 57328, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Plans": [{"Node Type": "Aggregate", "Strategy": "Sorted", "Partial Mode": "Partial", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 123031.24, "Total Cost": 135010.16, "Plan Rows": 299473, "Plan Width": 223, "Actual Startup Time": 1010.982, "Actual Total Time": 1335.859, "Actual Rows": 19109, "Actual Loops": 3, "Group Key": ["customer_1.c_customer_id", "customer_1.c_first_name", "customer_1.c_last_name", "customer_1.c_preferred_cust_flag", "customer_1.c_birth_country", "customer_1.c_login", "customer_1.c_email_address", "date_dim_1.d_year"], "Workers": [], "Plans": [{"Node Type": "Sort", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 123031.24, "Total Cost": 123779.92, "Plan Rows": 299473, "Plan Width": 204, "Actual Startup Time": 1010.944, "Actual Total Time": 1261.544, "Actual Rows": 239706, "Actual Loops": 3, "Sort Key": ["customer_1.c_customer_id", "customer_1.c_first_name", "customer_1.c_last_name", "customer_1.c_preferred_cust_flag", "customer_1.c_birth_country", "customer_1.c_login", "customer_1.c_email_address", "date_dim_1.d_year"], "Sort Method": "external merge", "Sort Space Used": 39392, "Sort Space Type": "Disk", "Workers": [{"Worker Number": 0, "Sort Method": "external merge", "Sort Space Used": 38592, "Sort Space Type": "Disk"}, {"Worker Number": 1, "Sort Method": "external merge", "Sort Space Used": 38568, "Sort Space Type": "Disk"}], "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 8015.36, "Total Cost": 36417.08, "Plan Rows": 299473, "Plan Width": 204, "Actual Startup Time": 137.94, "Actual Total Time": 177.869, "Actual Rows": 239706, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(web_sales.ws_bill_customer_sk = customer_1.c_customer_sk)", "Workers": [], "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 2371.82, "Total Cost": 24923.13, "Plan Rows": 299573, "Plan Width": 21, "Actual Startup Time": 4.694, "Actual Total Time": 68.786, "Actual Rows": 239732, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(web_sales.ws_sold_date_sk = date_dim_1.d_date_sk)", "Workers": [], "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Async Capable": false, "Relation Name": "web_sales", "Alias": "web_sales", "Startup Cost": 0.0, "Total Cost": 21764.43, "Plan Rows": 299743, "Plan Width": 21, "Actual Startup Time": 0.052, "Actual Total Time": 21.69, "Actual Rows": 239795, "Actual Loops": 3, "Workers": []}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Async Capable": false, "Startup Cost": 1834.7, "Total Cost": 1834.7, "Plan Rows": 42970, "Plan Width": 8, "Actual Startup Time": 4.563, "Actual Total Time": 4.564, "Actual Rows": 24350, "Actual Loops": 3, "Hash Buckets": 131072, "Original Hash Buckets": 131072, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 3904, "Workers": [], "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Async Capable": false, "Relation Name": "date_dim", "Alias": "date_dim_1", "Startup Cost": 0.0, "Total Cost": 1834.7, "Plan Rows": 42970, "Plan Width": 8, "Actual Startup Time": 0.006, "Actual Total Time": 2.019, "Actual Rows": 24350, "Actual Loops": 3, "Workers": []}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Async Capable": false, "Startup Cost": 3356.24, "Total Cost": 3356.24, "Plan Rows": 58824, "Plan Width": 191, "Actual Startup Time": 36.723, "Actual Total Time": 36.723, "Actual Rows": 33333, "Actual Loops": 3, "Hash Buckets": 32768, "Original Hash Buckets": 32768, "Hash Batches": 8, "Original Hash Batches": 8, "Peak Memory Usage": 2400, "Workers": [], "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Async Capable": false, "Relation Name": "customer", "Alias": "customer_1", "Startup Cost": 0.0, "Total Cost": 3356.24, "Plan Rows": 58824, "Plan Width": 191, "Actual Startup Time": 0.004, "Actual Total Time": 5.788, "Actual Rows": 33333, "Actual Loops": 3, "Workers": []}]}]}]}]}]}]}]}, {"Node Type": "Sort", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 351695.97, "Total Cost": 351695.98, "Plan Rows": 1, "Plan Width": 480, "Actual Startup Time": 1461707.293, "Actual Total Time": 1461707.298, "Actual Rows": 95, "Actual Loops": 1, "Sort Key": ["t_s_secyear.customer_id", "t_s_secyear.customer_first_name", "t_s_secyear.customer_last_name", "t_s_secyear.customer_email_address"], "Sort Method": "quicksort", "Sort Space Used": 49, "Sort Space Type": "Memory", "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 0.0, "Total Cost": 351695.96, "Plan Rows": 1, "Plan Width": 480, "Actual Startup Time": 6956.794, "Actual Total Time": 1461707.052, "Actual Rows": 95, "Actual Loops": 1, "Inner Unique": false, "Join Filter": "((t_s_secyear.customer_id = t_w_secyear.customer_id) AND (CASE WHEN (t_w_firstyear.year_total > '0'::numeric) THEN (t_w_secyear.year_total / t_w_firstyear.year_total) ELSE 0.0 END > CASE WHEN (t_s_firstyear.year_total > '0'::numeric) THEN (t_s_secyear.year_total / t_s_firstyear.year_total) ELSE 0.0 END))", "Rows Removed by Join Filter": 18909985, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 0.0, "Total Cost": 267960.72, "Plan Rows": 2, "Plan Width": 712, "Actual Startup Time": 6935.97, "Actual Total Time": 1416020.983, "Actual Rows": 1680, "Actual Loops": 1, "Inner Unique": false, "Join Filter": "(t_s_firstyear.customer_id = t_s_secyear.customer_id)", "Rows Removed by Join Filter": 163349376, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 0.0, "Total Cost": 184223.8, "Plan Rows": 4, "Plan Width": 200, "Actual Startup Time": 6935.94, "Actual Total Time": 1289995.062, "Actual Rows": 4332, "Actual Loops": 1, "Inner Unique": false, "Join Filter": "(t_s_firstyear.customer_id = t_w_firstyear.customer_id)", "Rows Removed by Join Filter": 429635887, "Plans": [{"Node Type": "CTE Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "CTE Name": "year_total", "Alias": "t_s_firstyear", "Startup Cost": 0.0, "Total Cost": 92103.22, "Plan Rows": 28, "Plan Width": 100, "Actual Startup Time": 4364.503, "Actual Total Time": 4519.811, "Actual Rows": 37991, "Actual Loops": 1, "Filter": "((year_total > '0'::numeric) AND (sale_type = 's'::text) AND (dyear = 1998))", "Rows Removed by Filter": 209239}, {"Node Type": "CTE Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Async Capable": false, "CTE Name": "year_total", "Alias": "t_w_firstyear", "Startup Cost": 0.0, "Total Cost": 92103.22, "Plan Rows": 28, "Plan Width": 100, "Actual Startup Time": 25.448, "Actual Total Time": 33.494, "Actual Rows": 11309, "Actual Loops": 37991, "Filter": "((year_total > '0'::numeric) AND (sale_type = 'w'::text) AND (dyear = 1998))", "Rows Removed by Filter": 235921}]}, {"Node Type": "CTE Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Async Capable": false, "CTE Name": "year_total", "Alias": "t_s_secyear", "Startup Cost": 0.0, "Total Cost": 83730.2, "Plan Rows": 84, "Plan Width": 512, "Actual Startup Time": 0.003, "Actual Total Time": 27.989, "Actual Rows": 37708, "Actual Loops": 4332, "Filter": "((sale_type = 's'::text) AND (dyear = 1999))", "Rows Removed by Filter": 209522}]}, {"Node Type": "CTE Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Async Capable": false, "CTE Name": "year_total", "Alias": "t_w_secyear", "Startup Cost": 0.0, "Total Cost": 83730.2, "Plan Rows": 84, "Plan Width": 100, "Actual Startup Time": 20.035, "Actual Total Time": 26.862, "Actual Rows": 11256, "Actual Loops": 1680, "Filter": "((sale_type = 'w'::text) AND (dyear = 1999))", "Rows Removed by Filter": 235974}]}]}]}, "Planning Time": 0.397, "Triggers": [], "Execution Time": 1461719.498}]
[{"Plan": {"Node Type": "Limit", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 76841.56, "Total Cost": 76841.57, "Plan Rows": 1, "Plan Width": 400, "Actual Startup Time": 1855.136, "Actual Total Time": 1855.233, "Actual Rows": 100, "Actual Loops": 1, "Plans": [{"Node Type": "WindowAgg", "Parent Relationship": "InitPlan", "Subplan Name": "CTE v1", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 72133.76, "Total Cost": 75050.63, "Plan Rows": 15240, "Plan Width": 195, "Actual Startup Time": 1246.468, "Actual Total Time": 1665.756, "Actual Rows": 63745, "Actual Loops": 1, "Plans": [{"Node Type": "WindowAgg", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 72133.76, "Total Cost": 74669.63, "Plan Rows": 15240, "Plan Width": 163, "Actual Startup Time": 1246.453, "Actual Total Time": 1634.326, "Actual Rows": 63745, "Actual Loops": 1, "Plans": [{"Node Type": "Aggregate", "Strategy": "Sorted", "Partial Mode": "Finalize", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 72133.76, "Total Cost": 74250.53, "Plan Rows": 15240, "Plan Width": 155, "Actual Startup Time": 1246.441, "Actual Total Time": 1600.406, "Actual Rows": 63745, "Actual Loops": 1, "Group Key": ["item.i_category", "item.i_brand", "store.s_store_name", "store.s_company_name", "date_dim.d_year", "date_dim.d_moy"], "Plans": [{"Node Type": "Gather Merge", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 72133.76, "Total Cost": 73806.03, "Plan Rows": 12700, "Plan Width": 155, "Actual Startup Time": 1246.423, "Actual Total Time": 1542.601, "Actual Rows": 143734, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Plans": [{"Node Type": "Aggregate", "Strategy": "Sorted", "Partial Mode": "Partial", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 71133.73, "Total Cost": 71340.11, "Plan Rows": 6350, "Plan Width": 155, "Actual Startup Time": 1242.528, "Actual Total Time": 1500.122, "Actual Rows": 47911, "Actual Loops": 3, "Group Key": ["item.i_category", "item.i_brand", "store.s_store_name", "store.s_company_name", "date_dim.d_year", "date_dim.d_moy"], "Workers": [], "Plans": [{"Node Type": "Sort", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 71133.73, "Total Cost": 71149.61, "Plan Rows": 6350, "Plan Width": 129, "Actual Startup Time": 1242.504, "Actual Total Time": 1443.179, "Actual Rows": 220395, "Actual Loops": 3, "Sort Key": ["item.i_category", "item.i_brand", "store.s_store_name", "store.s_company_name", "date_dim.d_year", "date_dim.d_moy"], "Sort Method": "external merge", "Sort Space Used": 30280, "Sort Space Type": "Disk", "Workers": [{"Worker Number": 0, "Sort Method": "external merge", "Sort Space Used": 30448, "Sort Space Type": "Disk"}, {"Worker Number": 1, "Sort Method": "external merge", "Sort Space Used": 30280, "Sort Space Type": "Disk"}], "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 3844.44, "Total Cost": 70732.65, "Plan Rows": 6350, "Plan Width": 129, "Actual Startup Time": 4.195, "Actual Total Time": 182.862, "Actual Rows": 220395, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(store_sales.ss_item_sk = item.i_item_sk)", "Workers": [], "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 2376.21, "Total Cost": 69247.75, "Plan Rows": 6350, "Plan Width": 31, "Actual Startup Time": 2.269, "Actual Total Time": 146.399, "Actual Rows": 220395, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(store_sales.ss_store_sk = store.s_store_sk)", "Workers": [], "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 2374.94, "Total Cost": 69223.16, "Plan Rows": 6641, "Plan Width": 22, "Actual Startup Time": 2.235, "Actual Total Time": 128.783, "Actual Rows": 225702, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(store_sales.ss_sold_date_sk = date_dim.d_date_sk)", "Workers": [], "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Async Capable": false, "Relation Name": "store_sales", "Alias": "store_sales", "Startup Cost": 0.0, "Total Cost": 63697.62, "Plan Rows": 1200162, "Plan Width": 18, "Actual Startup Time": 0.027, "Actual Total Time": 55.057, "Actual Rows": 960135, "Actual Loops": 3, "Workers": []}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Async Capable": false, "Startup Cost": 2371.82, "Total Cost": 2371.82, "Plan Rows": 249, "Plan Width": 12, "Actual Startup Time": 2.175, "Actual Total Time": 2.176, "Actual Rows": 143, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 104, "Workers": [], "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Async Capable": false, "Relation Name": "date_dim", "Alias": "date_dim", "Startup Cost": 0.0, "Total Cost": 2371.82, "Plan Rows": 249, "Plan Width": 12, "Actual Startup Time": 1.058, "Actual Total Time": 2.124, "Actual Rows": 143, "Actual Loops": 3, "Filter": "((d_year = 2000) OR ((d_year = 1999) AND (d_moy = 12)) OR ((d_year = 2001) AND (d_moy = 1)))", "Rows Removed by Filter": 24207, "Workers": []}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 1.12, "Total Cost": 1.12, "Plan Rows": 12, "Plan Width": 17, "Actual Startup Time": 0.027, "Actual Total Time": 0.027, "Actual Rows": 12, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Workers": [], "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Relation Name": "store", "Alias": "store", "Startup Cost": 0.0, "Total Cost": 1.12, "Plan Rows": 12, "Plan Width": 17, "Actual Startup Time": 0.019, "Actual Total Time": 0.021, "Actual Rows": 12, "Actual Loops": 3, "Workers": []}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Async Capable": false, "Startup Cost": 1335.88, "Total Cost": 1335.88, "Plan Rows": 10588, "Plan Width": 106, "Actual Startup Time": 1.877, "Actual Total Time": 1.877, "Actual Rows": 6000, "Actual Loops": 3, "Hash Buckets": 32768, "Original Hash Buckets": 32768, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 2848, "Workers": [], "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Async Capable": false, "Relation Name": "item", "Alias": "item", "Startup Cost": 0.0, "Total Cost": 1335.88, "Plan Rows": 10588, "Plan Width": 106, "Actual Startup Time": 0.004, "Actual Total Time": 1.218, "Actual Rows": 6000, "Actual Loops": 3, "Workers": []}]}]}]}]}]}]}]}]}, {"Node Type": "Sort", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 1790.94, "Total Cost": 1790.94, "Plan Rows": 1, "Plan Width": 400, "Actual Startup Time": 1855.135, "Actual Total Time": 1855.137, "Actual Rows": 100, "Actual Loops": 1, "Sort Key": ["((v1.sum_sales - v1.avg_monthly_sales))", "v1_lead.sum_sales"], "Sort Method": "top-N heapsort", "Sort Space Used": 48, "Sort Space Type": "Memory", "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 1181.31, "Total Cost": 1790.93, "Plan Rows": 1, "Plan Width": 400, "Actual Startup Time": 1801.267, "Actual Total Time": 1847.4, "Actual Rows": 47161, "Actual Loops": 1, "Inner Unique": false, "Hash Cond": "((v1_lead.i_category = v1.i_category) AND (v1_lead.i_brand = v1.i_brand) AND ((v1_lead.s_store_name)::text = (v1.s_store_name)::text) AND ((v1_lead.s_company_name)::text = (v1.s_company_name)::text) AND ((v1_lead.rn - 1) = v1.rn))", "Plans": [{"Node Type": "CTE Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "CTE Name": "v1", "Alias": "v1_lead", "Startup Cost": 0.0, "Total Cost": 304.8, "Plan Rows": 15240, "Plan Width": 684, "Actual Startup Time": 1246.469, "Actual Total Time": 1250.269, "Actual Rows": 63745, "Actual Loops": 1}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 1181.29, "Total Cost": 1181.29, "Plan Rows": 1, "Plan Width": 1404, "Actual Startup Time": 554.645, "Actual Total Time": 554.645, "Actual Rows": 48992, "Actual Loops": 1, "Hash Buckets": 16384, "Original Hash Buckets": 1024, "Hash Batches": 4, "Original Hash Batches": 1, "Peak Memory Usage": 3969, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 571.68, "Total Cost": 1181.29, "Plan Rows": 1, "Plan Width": 1404, "Actual Startup Time": 489.495, "Actual Total Time": 533.505, "Actual Rows": 48992, "Actual Loops": 1, "Inner Unique": false, "Hash Cond": "((v1_lag.i_category = v1.i_category) AND (v1_lag.i_brand = v1.i_brand) AND ((v1_lag.s_store_name)::text = (v1.s_store_name)::text) AND ((v1_lag.s_company_name)::text = (v1.s_company_name)::text) AND ((v1_lag.rn + 1) = v1.rn))", "Plans": [{"Node Type": "CTE Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "CTE Name": "v1", "Alias": "v1_lag", "Startup Cost": 0.0, "Total Cost": 304.8, "Plan Rows": 15240, "Plan Width": 684, "Actual Startup Time": 0.003, "Actual Total Time": 4.007, "Actual Rows": 63745, "Actual Loops": 1}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 571.5, "Total Cost": 571.5, "Plan Rows": 8, "Plan Width": 720, "Actual Startup Time": 489.312, "Actual Total Time": 489.312, "Actual Rows": 49299, "Actual Loops": 1, "Hash Buckets": 32768, "Original Hash Buckets": 1024, "Hash Batches": 4, "Original Hash Batches": 1, "Peak Memory Usage": 3841, "Plans": [{"Node Type": "CTE Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "CTE Name": "v1", "Alias": "v1", "Startup Cost": 0.0, "Total Cost": 571.5, "Plan Rows": 8, "Plan Width": 720, "Actual Startup Time": 0.233, "Actual Total Time": 470.842, "Actual Rows": 50169, "Actual Loops": 1, "Filter": "((avg_monthly_sales > '0'::numeric) AND (d_year = 2000) AND (CASE WHEN (avg_monthly_sales > '0'::numeric) THEN (abs((sum_sales - avg_monthly_sales)) / avg_monthly_sales) ELSE NULL::numeric END > 0.1))", "Rows Removed by Filter": 13576}]}]}]}]}]}]}, "Planning Time": 0.357, "Triggers": [], "Execution Time": 1860.318}]
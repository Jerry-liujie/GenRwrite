[{"Plan": {"Node Type": "Limit", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 19887.78, "Total Cost": 19887.8, "Plan Rows": 7, "Plan Width": 236, "Actual Startup Time": 36098.863, "Actual Total Time": 36098.929, "Actual Rows": 100, "Actual Loops": 1, "Plans": [{"Node Type": "Aggregate", "Strategy": "Sorted", "Partial Mode": "Finalize", "Parent Relationship": "InitPlan", "Subplan Name": "CTE customer_total_return", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 7053.06, "Total Cost": 7121.55, "Plan Rows": 700, "Plan Width": 39, "Actual Startup Time": 40.618, "Actual Total Time": 58.495, "Actual Rows": 27598, "Actual Loops": 1, "Group Key": ["catalog_returns.cr_returning_customer_sk", "customer_address_1.ca_state"], "Plans": [{"Node Type": "Gather Merge", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 7053.06, "Total Cost": 7108.68, "Plan Rows": 412, "Plan Width": 39, "Actual Startup Time": 40.612, "Actual Total Time": 48.557, "Actual Rows": 27698, "Actual Loops": 1, "Workers Planned": 1, "Workers Launched": 1, "Plans": [{"Node Type": "Aggregate", "Strategy": "Sorted", "Partial Mode": "Partial", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 6053.05, "Total Cost": 6062.32, "Plan Rows": 412, "Plan Width": 39, "Actual Startup Time": 39.084, "Actual Total Time": 44.105, "Actual Rows": 13849, "Actual Loops": 2, "Group Key": ["catalog_returns.cr_returning_customer_sk", "customer_address_1.ca_state"], "Workers": [], "Plans": [{"Node Type": "Sort", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 6053.05, "Total Cost": 6054.08, "Plan Rows": 412, "Plan Width": 13, "Actual Startup Time": 39.074, "Actual Total Time": 39.689, "Actual Rows": 14034, "Actual Loops": 2, "Sort Key": ["catalog_returns.cr_returning_customer_sk", "customer_address_1.ca_state"], "Sort Method": "quicksort", "Sort Space Used": 1082, "Sort Space Type": "Memory", "Workers": [{"Worker Number": 0, "Sort Method": "quicksort", "Sort Space Used": 1003, "Sort Space Type": "Memory"}], "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 1945.08, "Total Cost": 6035.15, "Plan Rows": 412, "Plan Width": 13, "Actual Startup Time": 6.037, "Actual Total Time": 36.453, "Actual Rows": 14034, "Actual Loops": 2, "Inner Unique": true, "Workers": [], "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 1944.79, "Total Cost": 5891.71, "Plan Rows": 420, "Plan Width": 14, "Actual Startup Time": 6.014, "Actual Total Time": 20.295, "Actual Rows": 14313, "Actual Loops": 2, "Inner Unique": true, "Hash Cond": "(catalog_returns.cr_returned_date_sk = date_dim.d_date_sk)", "Workers": [], "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Async Capable": false, "Relation Name": "catalog_returns", "Alias": "catalog_returns", "Startup Cost": 0.0, "Total Cost": 3724.45, "Plan Rows": 84745, "Plan Width": 18, "Actual Startup Time": 0.026, "Actual Total Time": 8.832, "Actual Rows": 72034, "Actual Loops": 2, "Workers": []}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Async Capable": false, "Startup Cost": 1942.12, "Total Cost": 1942.12, "Plan Rows": 213, "Plan Width": 4, "Actual Startup Time": 4.641, "Actual Total Time": 4.641, "Actual Rows": 182, "Actual Loops": 2, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 72, "Workers": [], "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Async Capable": false, "Relation Name": "date_dim", "Alias": "date_dim", "Startup Cost": 0.0, "Total Cost": 1942.12, "Plan Rows": 213, "Plan Width": 4, "Actual Startup Time": 2.0, "Actual Total Time": 4.589, "Actual Rows": 182, "Actual Loops": 2, "Filter": "(d_year = 2001)", "Rows Removed by Filter": 36342, "Workers": []}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Async Capable": false, "Scan Direction": "Forward", "Index Name": "customer_address_pkey", "Relation Name": "customer_address", "Alias": "customer_address_1", "Startup Cost": 0.29, "Total Cost": 0.34, "Plan Rows": 1, "Plan Width": 7, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 1, "Actual Loops": 28626, "Index Cond": "(ca_address_sk = catalog_returns.cr_returning_addr_sk)", "Rows Removed by Index Recheck": 0, "Workers": []}]}]}]}]}]}, {"Node Type": "Sort", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 12766.23, "Total Cost": 12766.25, "Plan Rows": 7, "Plan Width": 236, "Actual Startup Time": 36098.863, "Actual Total Time": 36098.865, "Actual Rows": 100, "Actual Loops": 1, "Sort Key": ["customer.c_customer_id", "customer.c_salutation", "customer.c_first_name", "customer.c_last_name", "customer_address.ca_street_number", "customer_address.ca_street_name", "customer_address.ca_street_type", "customer_address.ca_suite_number", "customer_address.ca_city", "customer_address.ca_county", "customer_address.ca_zip", "customer_address.ca_country", "customer_address.ca_gmt_offset", "customer_address.ca_location_type", "ctr1.ctr_total_return"], "Sort Method": "quicksort", "Sort Space Used": 76, "Sort Space Type": "Memory", "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 0.58, "Total Cost": 12766.14, "Plan Rows": 7, "Plan Width": 236, "Actual Startup Time": 657.04, "Actual Total Time": 36097.922, "Actual Rows": 192, "Actual Loops": 1, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 0.29, "Total Cost": 12682.48, "Plan Rows": 233, "Plan Width": 116, "Actual Startup Time": 63.57, "Actual Total Time": 36070.836, "Actual Rows": 6802, "Actual Loops": 1, "Inner Unique": true, "Plans": [{"Node Type": "CTE Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "CTE Name": "customer_total_return", "Alias": "ctr1", "Startup Cost": 0.0, "Total Cost": 11058.25, "Plan Rows": 233, "Plan Width": 36, "Actual Startup Time": 63.558, "Actual Total Time": 36020.14, "Actual Rows": 6827, "Actual Loops": 1, "Filter": "(ctr_total_return > (SubPlan 2))", "Rows Removed by Filter": 20771, "Plans": [{"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Simple", "Parent Relationship": "SubPlan", "Subplan Name": "SubPlan 2", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 15.76, "Total Cost": 15.77, "Plan Rows": 1, "Plan Width": 32, "Actual Startup Time": 1.303, "Actual Total Time": 1.303, "Actual Rows": 1, "Actual Loops": 27598, "Plans": [{"Node Type": "CTE Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "CTE Name": "customer_total_return", "Alias": "ctr2", "Startup Cost": 0.0, "Total Cost": 15.75, "Plan Rows": 4, "Plan Width": 32, "Actual Startup Time": 0.033, "Actual Total Time": 1.263, "Actual Rows": 804, "Actual Loops": 27598, "Filter": "(ctr1.ctr_state = ctr_state)", "Rows Removed by Filter": 26794}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Async Capable": false, "Scan Direction": "Forward", "Index Name": "customer_pkey", "Relation Name": "customer", "Alias": "customer", "Startup Cost": 0.29, "Total Cost": 6.97, "Plan Rows": 1, "Plan Width": 88, "Actual Startup Time": 0.006, "Actual Total Time": 0.006, "Actual Rows": 1, "Actual Loops": 6827, "Index Cond": "(c_customer_sk = ctr1.ctr_customer_sk)", "Rows Removed by Index Recheck": 0}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Async Capable": false, "Scan Direction": "Forward", "Index Name": "customer_address_pkey", "Relation Name": "customer_address", "Alias": "customer_address", "Startup Cost": 0.29, "Total Cost": 0.36, "Plan Rows": 1, "Plan Width": 128, "Actual Startup Time": 0.004, "Actual Total Time": 0.004, "Actual Rows": 0, "Actual Loops": 6802, "Index Cond": "(ca_address_sk = customer.c_current_addr_sk)", "Rows Removed by Index Recheck": 0, "Filter": "(ca_state = 'TN'::bpchar)", "Rows Removed by Filter": 1}]}]}]}, "Planning Time": 1.898, "Triggers": [], "Execution Time": 36099.324}]
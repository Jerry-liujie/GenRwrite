[{"Plan": {"Node Type": "Sort", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 140338.23, "Total Cost": 140338.23, "Plan Rows": 1, "Plan Width": 152, "Actual Startup Time": 2129.689, "Actual Total Time": 2131.661, "Actual Rows": 230, "Actual Loops": 1, "Sort Key": ["inv1.w_warehouse_sk", "inv1.i_item_sk", "inv1.mean", "inv1.cov", "inv2.mean", "inv2.cov"], "Sort Method": "quicksort", "Sort Space Used": 57, "Sort Space Type": "Memory", "Plans": [{"Node Type": "Subquery Scan", "Parent Relationship": "InitPlan", "Subplan Name": "CTE inv", "Parallel Aware": false, "Async Capable": false, "Alias": "foo", "Startup Cost": 130867.45, "Total Cost": 139460.8, "Plan Rows": 19401, "Plan Width": 126, "Actual Startup Time": 894.548, "Actual Total Time": 2116.914, "Actual Rows": 34172, "Actual Loops": 1, "Plans": [{"Node Type": "Aggregate", "Strategy": "Sorted", "Partial Mode": "Finalize", "Parent Relationship": "Subquery", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 130867.45, "Total Cost": 139169.78, "Plan Rows": 19401, "Plan Width": 94, "Actual Startup Time": 894.546, "Actual Total Time": 2109.213, "Actual Rows": 34172, "Actual Loops": 1, "Group Key": ["warehouse.w_warehouse_sk", "item.i_item_sk", "date_dim.d_moy"], "Filter": "(CASE avg(inventory.inv_quantity_on_hand) WHEN '0'::numeric THEN '0'::numeric ELSE (stddev_samp(inventory.inv_quantity_on_hand) / avg(inventory.inv_quantity_on_hand)) END > '1'::numeric)", "Rows Removed by Filter": 505828, "Plans": [{"Node Type": "Gather Merge", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 130867.45, "Total Cost": 137132.69, "Plan Rows": 48502, "Plan Width": 94, "Actual Startup Time": 894.506, "Actual Total Time": 1347.125, "Actual Rows": 1391960, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Plans": [{"Node Type": "Aggregate", "Strategy": "Sorted", "Partial Mode": "Partial", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 129867.43, "Total Cost": 130534.33, "Plan Rows": 24251, "Plan Width": 94, "Actual Startup Time": 892.176, "Actual Total Time": 1184.797, "Actual Rows": 463987, "Actual Loops": 3, "Group Key": ["warehouse.w_warehouse_sk", "item.i_item_sk", "date_dim.d_moy"], "Workers": [], "Plans": [{"Node Type": "Sort", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 129867.43, "Total Cost": 129928.05, "Plan Rows": 24251, "Plan Width": 34, "Actual Startup Time": 892.163, "Actual Total Time": 990.18, "Actual Rows": 780000, "Actual Loops": 3, "Sort Key": ["warehouse.w_warehouse_sk", "item.i_item_sk", "date_dim.d_moy"], "Sort Method": "external merge", "Sort Space Used": 32136, "Sort Space Type": "Disk", "Workers": [{"Worker Number": 0, "Sort Method": "external merge", "Sort Space Used": 31416, "Sort Space Type": "Disk"}, {"Worker Number": 1, "Sort Method": "external merge", "Sort Space Used": 32176, "Sort Space Type": "Disk"}], "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 2649.19, "Total Cost": 128101.25, "Plan Rows": 24251, "Plan Width": 34, "Actual Startup Time": 206.275, "Actual Total Time": 660.226, "Actual Rows": 780000, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(inventory.inv_warehouse_sk = warehouse.w_warehouse_sk)", "Workers": [], "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 2648.07, "Total Cost": 127982.53, "Plan Rows": 24251, "Plan Width": 16, "Actual Startup Time": 206.232, "Actual Total Time": 602.514, "Actual Rows": 780000, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(inventory.inv_item_sk = item.i_item_sk)", "Workers": [], "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 1944.79, "Total Cost": 127215.57, "Plan Rows": 24251, "Plan Width": 16, "Actual Startup Time": 204.546, "Actual Total Time": 523.834, "Actual Rows": 780000, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(inventory.inv_date_sk = date_dim.d_date_sk)", "Workers": [], "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Async Capable": false, "Relation Name": "inventory", "Alias": "inventory", "Startup Cost": 0.0, "Total Cost": 112424.06, "Plan Rows": 4893706, "Plan Width": 16, "Actual Startup Time": 0.037, "Actual Total Time": 171.218, "Actual Rows": 3915000, "Actual Loops": 3, "Workers": []}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Async Capable": false, "Startup Cost": 1942.12, "Total Cost": 1942.12, "Plan Rows": 213, "Plan Width": 8, "Actual Startup Time": 1.512, "Actual Total Time": 1.512, "Actual Rows": 122, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 40, "Workers": [], "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Async Capable": false, "Relation Name": "date_dim", "Alias": "date_dim", "Startup Cost": 0.0, "Total Cost": 1942.12, "Plan Rows": 213, "Plan Width": 8, "Actual Startup Time": 1.111, "Actual Total Time": 1.492, "Actual Rows": 122, "Actual Loops": 3, "Filter": "(d_year = 2000)", "Rows Removed by Filter": 24228, "Workers": []}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 478.29, "Total Cost": 478.29, "Plan Rows": 18000, "Plan Width": 4, "Actual Startup Time": 1.653, "Actual Total Time": 1.654, "Actual Rows": 18000, "Actual Loops": 3, "Hash Buckets": 32768, "Original Hash Buckets": 32768, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 889, "Workers": [], "Plans": [{"Node Type": "Index Only Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Scan Direction": "Forward", "Index Name": "item_pkey", "Relation Name": "item", "Alias": "item", "Startup Cost": 0.29, "Total Cost": 478.29, "Plan Rows": 18000, "Plan Width": 4, "Actual Startup Time": 0.03, "Actual Total Time": 0.709, "Actual Rows": 18000, "Actual Loops": 3, "Heap Fetches": 0, "Workers": []}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 1.05, "Total Cost": 1.05, "Plan Rows": 5, "Plan Width": 22, "Actual Startup Time": 0.032, "Actual Total Time": 0.032, "Actual Rows": 5, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9, "Workers": [], "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Relation Name": "warehouse", "Alias": "warehouse", "Startup Cost": 0.0, "Total Cost": 1.05, "Plan Rows": 5, "Plan Width": 22, "Actual Startup Time": 0.024, "Actual Total Time": 0.025, "Actual Rows": 5, "Actual Loops": 3, "Workers": []}]}]}]}]}]}]}]}, {"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 437.98, "Total Cost": 877.42, "Plan Rows": 1, "Plan Width": 152, "Actual Startup Time": 2127.179, "Actual Total Time": 2129.659, "Actual Rows": 230, "Actual Loops": 1, "Inner Unique": false, "Hash Cond": "((inv1.i_item_sk = inv2.i_item_sk) AND (inv1.w_warehouse_sk = inv2.w_warehouse_sk))", "Plans": [{"Node Type": "CTE Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "CTE Name": "inv", "Alias": "inv1", "Startup Cost": 0.0, "Total Cost": 436.52, "Plan Rows": 97, "Plan Width": 76, "Actual Startup Time": 894.549, "Actual Total Time": 896.821, "Actual Rows": 3135, "Actual Loops": 1, "Filter": "(d_moy = 1)", "Rows Removed by Filter": 31037}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 436.52, "Total Cost": 436.52, "Plan Rows": 97, "Plan Width": 76, "Actual Startup Time": 1232.598, "Actual Total Time": 1232.598, "Actual Rows": 3220, "Actual Loops": 1, "Hash Buckets": 4096, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 235, "Plans": [{"Node Type": "CTE Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "CTE Name": "inv", "Alias": "inv2", "Startup Cost": 0.0, "Total Cost": 436.52, "Plan Rows": 97, "Plan Width": 76, "Actual Startup Time": 0.369, "Actual Total Time": 1230.824, "Actual Rows": 3220, "Actual Loops": 1, "Filter": "(d_moy = 2)", "Rows Removed by Filter": 30952}]}]}]}, "Planning Time": 0.374, "Triggers": [], "Execution Time": 2134.676}]
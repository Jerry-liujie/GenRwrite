[{"Plan": {"Node Type": "Limit", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 100164.78, "Total Cost": 100175.28, "Plan Rows": 100, "Plan Width": 136, "Actual Startup Time": 921.983, "Actual Total Time": 922.993, "Actual Rows": 100, "Actual Loops": 1, "Plans": [{"Node Type": "Subquery Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Alias": "y", "Startup Cost": 100164.78, "Total Cost": 100702.87, "Plan Rows": 5125, "Plan Width": 136, "Actual Startup Time": 921.983, "Actual Total Time": 922.99, "Actual Rows": 100, "Actual Loops": 1, "Filter": "(y.web_cumulative > y.store_cumulative)", "Rows Removed by Filter": 2907, "Plans": [{"Node Type": "WindowAgg", "Parent Relationship": "Subquery", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 100164.78, "Total Cost": 100510.7, "Plan Rows": 15374, "Plan Width": 136, "Actual Startup Time": 921.958, "Actual Total Time": 922.907, "Actual Rows": 3007, "Actual Loops": 1, "Plans": [{"Node Type": "Sort", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 100164.78, "Total Cost": 100203.22, "Plan Rows": 15374, "Plan Width": 72, "Actual Startup Time": 921.954, "Actual Total Time": 922.138, "Actual Rows": 3008, "Actual Loops": 1, "Sort Key": ["(CASE WHEN (web_sales.ws_item_sk IS NOT NULL) THEN web_sales.ws_item_sk ELSE store_sales.ss_item_sk END)", "(CASE WHEN (date_dim.d_date IS NOT NULL) THEN date_dim.d_date ELSE date_dim_1.d_date END)"], "Sort Method": "external merge", "Sort Space Used": 15104, "Sort Space Type": "Disk", "Plans": [{"Node Type": "Merge Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Join Type": "Full", "Startup Cost": 95999.28, "Total Cost": 99095.66, "Plan Rows": 15374, "Plan Width": 72, "Actual Startup Time": 248.999, "Actual Total Time": 851.633, "Actual Rows": 608686, "Actual Loops": 1, "Inner Unique": true, "Merge Cond": "((web_sales.ws_item_sk = store_sales.ss_item_sk) AND (date_dim.d_date = date_dim_1.d_date))", "Plans": [{"Node Type": "WindowAgg", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 25693.45, "Total Cost": 26271.25, "Plan Rows": 4016, "Plan Width": 40, "Actual Startup Time": 54.957, "Actual Total Time": 178.46, "Actual Rows": 143038, "Actual Loops": 1, "Plans": [{"Node Type": "Aggregate", "Strategy": "Sorted", "Partial Mode": "Finalize", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 25693.45, "Total Cost": 26200.97, "Plan Rows": 4016, "Plan Width": 40, "Actual Startup Time": 54.95, "Actual Total Time": 136.842, "Actual Rows": 143038, "Actual Loops": 1, "Group Key": ["web_sales.ws_item_sk", "date_dim.d_date"], "Plans": [{"Node Type": "Gather Merge", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 25693.45, "Total Cost": 26117.31, "Plan Rows": 3346, "Plan Width": 40, "Actual Startup Time": 54.94, "Actual Total Time": 86.522, "Actual Rows": 145710, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Plans": [{"Node Type": "Aggregate", "Strategy": "Sorted", "Partial Mode": "Partial", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 24693.43, "Total Cost": 24731.07, "Plan Rows": 1673, "Plan Width": 40, "Actual Startup Time": 53.112, "Actual Total Time": 69.756, "Actual Rows": 48570, "Actual Loops": 3, "Group Key": ["web_sales.ws_item_sk", "date_dim.d_date"], "Workers": [], "Plans": [{"Node Type": "Sort", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 24693.43, "Total Cost": 24697.61, "Plan Rows": 1673, "Plan Width": 14, "Actual Startup Time": 53.099, "Actual Total Time": 54.968, "Actual Rows": 49006, "Actual Loops": 3, "Sort Key": ["web_sales.ws_item_sk", "date_dim.d_date"], "Sort Method": "quicksort", "Sort Space Used": 3663, "Sort Space Type": "Memory", "Workers": [{"Worker Number": 0, "Sort Method": "quicksort", "Sort Space Used": 3643, "Sort Space Type": "Memory"}, {"Worker Number": 1, "Sort Method": "quicksort", "Sort Space Used": 3683, "Sort Space Type": "Memory"}], "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 2052.55, "Total Cost": 24603.85, "Plan Rows": 1673, "Plan Width": 14, "Actual Startup Time": 1.557, "Actual Total Time": 43.615, "Actual Rows": 49006, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(web_sales.ws_sold_date_sk = date_dim.d_date_sk)", "Workers": [], "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Async Capable": false, "Relation Name": "web_sales", "Alias": "web_sales", "Startup Cost": 0.0, "Total Cost": 21764.43, "Plan Rows": 299743, "Plan Width": 14, "Actual Startup Time": 0.025, "Actual Total Time": 25.421, "Actual Rows": 239795, "Actual Loops": 3, "Filter": "(ws_item_sk IS NOT NULL)", "Rows Removed by Filter": 0, "Workers": []}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Async Capable": false, "Startup Cost": 2049.55, "Total Cost": 2049.55, "Plan Rows": 240, "Plan Width": 8, "Actual Startup Time": 1.475, "Actual Total Time": 1.476, "Actual Rows": 122, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 40, "Workers": [], "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Async Capable": false, "Relation Name": "date_dim", "Alias": "date_dim", "Startup Cost": 0.0, "Total Cost": 2049.55, "Plan Rows": 240, "Plan Width": 8, "Actual Startup Time": 1.045, "Actual Total Time": 1.455, "Actual Rows": 122, "Actual Loops": 3, "Filter": "((d_month_seq >= 1212) AND (d_month_seq <= 1223))", "Rows Removed by Filter": 24228, "Workers": []}]}]}]}]}]}]}]}, {"Node Type": "WindowAgg", "Parent Relationship": "Inner", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 70305.82, "Total Cost": 72518.12, "Plan Rows": 15374, "Plan Width": 40, "Actual Startup Time": 194.039, "Actual Total Time": 630.643, "Actual Rows": 492490, "Actual Loops": 1, "Plans": [{"Node Type": "Aggregate", "Strategy": "Sorted", "Partial Mode": "Finalize", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 70305.82, "Total Cost": 72249.08, "Plan Rows": 15374, "Plan Width": 40, "Actual Startup Time": 194.033, "Actual Total Time": 493.454, "Actual Rows": 492490, "Actual Loops": 1, "Group Key": ["store_sales.ss_item_sk", "date_dim_1.d_date"], "Plans": [{"Node Type": "Gather Merge", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 70305.82, "Total Cost": 71928.78, "Plan Rows": 12812, "Plan Width": 40, "Actual Startup Time": 194.028, "Actual Total Time": 316.991, "Actual Rows": 527230, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Plans": [{"Node Type": "Aggregate", "Strategy": "Sorted", "Partial Mode": "Partial", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 69305.8, "Total Cost": 69449.94, "Plan Rows": 6406, "Plan Width": 40, "Actual Startup Time": 191.533, "Actual Total Time": 258.795, "Actual Rows": 175743, "Actual Loops": 3, "Group Key": ["store_sales.ss_item_sk", "date_dim_1.d_date"], "Workers": [], "Plans": [{"Node Type": "Sort", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 69305.8, "Total Cost": 69321.82, "Plan Rows": 6406, "Plan Width": 14, "Actual Startup Time": 191.522, "Actual Total Time": 204.51, "Actual Rows": 182103, "Actual Loops": 3, "Sort Key": ["store_sales.ss_item_sk", "date_dim_1.d_date"], "Sort Method": "external merge", "Sort Space Used": 4544, "Sort Space Type": "Disk", "Workers": [{"Worker Number": 0, "Sort Method": "external merge", "Sort Space Used": 4344, "Sort Space Type": "Disk"}, {"Worker Number": 1, "Sort Method": "external merge", "Sort Space Used": 4368, "Sort Space Type": "Disk"}], "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 2052.55, "Total Cost": 68900.77, "Plan Rows": 6406, "Plan Width": 14, "Actual Startup Time": 1.618, "Actual Total Time": 146.344, "Actual Rows": 182103, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(store_sales.ss_sold_date_sk = date_dim_1.d_date_sk)", "Workers": [], "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Async Capable": false, "Relation Name": "store_sales", "Alias": "store_sales", "Startup Cost": 0.0, "Total Cost": 63697.62, "Plan Rows": 1200162, "Plan Width": 14, "Actual Startup Time": 0.036, "Actual Total Time": 83.633, "Actual Rows": 960135, "Actual Loops": 3, "Filter": "(ss_item_sk IS NOT NULL)", "Rows Removed by Filter": 0, "Workers": []}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Async Capable": false, "Startup Cost": 2049.55, "Total Cost": 2049.55, "Plan Rows": 240, "Plan Width": 8, "Actual Startup Time": 1.542, "Actual Total Time": 1.542, "Actual Rows": 122, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 40, "Workers": [], "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Async Capable": false, "Relation Name": "date_dim", "Alias": "date_dim_1", "Startup Cost": 0.0, "Total Cost": 2049.55, "Plan Rows": 240, "Plan Width": 8, "Actual Startup Time": 1.109, "Actual Total Time": 1.516, "Actual Rows": 122, "Actual Loops": 3, "Filter": "((d_month_seq >= 1212) AND (d_month_seq <= 1223))", "Rows Removed by Filter": 24228, "Workers": []}]}]}]}]}]}]}]}]}]}]}]}]}, "Planning Time": 0.208, "Triggers": [], "Execution Time": 925.428}]
[
    {
        "Plan": {
            "Node Type": "Limit",
            "Parallel Aware": false,
            "Async Capable": false,
            "Startup Cost": 108936.17,
            "Total Cost": 108936.18,
            "Plan Rows": 1,
            "Plan Width": 276,
            "Actual Startup Time": 576131.635,
            "Actual Total Time": 576131.797,
            "Actual Rows": 100,
            "Actual Loops": 1,
            "Plans": [
                {
                    "Node Type": "Append",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE year_total",
                    "Parallel Aware": false,
                    "Async Capable": false,
                    "Startup Cost": 74095.73,
                    "Total Cost": 105450.64,
                    "Plan Rows": 33195,
                    "Plan Width": 137,
                    "Actual Startup Time": 1658.274,
                    "Actual Total Time": 2844.49,
                    "Actual Rows": 98369,
                    "Actual Loops": 1,
                    "Subplans Removed": 0,
                    "Plans": [
                        {
                            "Node Type": "Aggregate",
                            "Strategy": "Sorted",
                            "Partial Mode": "Finalize",
                            "Parent Relationship": "Member",
                            "Parallel Aware": false,
                            "Async Capable": false,
                            "Startup Cost": 74095.73,
                            "Total Cost": 77407.31,
                            "Plan Rows": 26071,
                            "Plan Width": 137,
                            "Actual Startup Time": 1658.274,
                            "Actual Total Time": 2221.616,
                            "Actual Rows": 75960,
                            "Actual Loops": 1,
                            "Group Key": [
                                "customer.c_customer_id",
                                "customer.c_first_name",
                                "customer.c_last_name",
                                "date_dim.d_year"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Gather Merge",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Async Capable": false,
                                    "Startup Cost": 74095.73,
                                    "Total Cost": 76875.02,
                                    "Plan Rows": 21726,
                                    "Plan Width": 105,
                                    "Actual Startup Time": 1658.253,
                                    "Actual Total Time": 2200.182,
                                    "Actual Rows": 89305,
                                    "Actual Loops": 1,
                                    "Workers Planned": 2,
                                    "Workers Launched": 2,
                                    "Plans": [
                                        {
                                            "Node Type": "Aggregate",
                                            "Strategy": "Sorted",
                                            "Partial Mode": "Partial",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Async Capable": false,
                                            "Startup Cost": 73095.7,
                                            "Total Cost": 73367.28,
                                            "Plan Rows": 10863,
                                            "Plan Width": 105,
                                            "Actual Startup Time": 1632.932,
                                            "Actual Total Time": 2075.71,
                                            "Actual Rows": 29768,
                                            "Actual Loops": 3,
                                            "Group Key": [
                                                "customer.c_customer_id",
                                                "customer.c_first_name",
                                                "customer.c_last_name",
                                                "date_dim.d_year"
                                            ],
                                            "Workers": [],
                                            "Plans": [
                                                {
                                                    "Node Type": "Sort",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Async Capable": false,
                                                    "Startup Cost": 73095.7,
                                                    "Total Cost": 73122.86,
                                                    "Plan Rows": 10863,
                                                    "Plan Width": 79,
                                                    "Actual Startup Time": 1632.902,
                                                    "Actual Total Time": 2014.595,
                                                    "Actual Rows": 357343,
                                                    "Actual Loops": 3,
                                                    "Sort Key": [
                                                        "customer.c_customer_id",
                                                        "customer.c_first_name",
                                                        "customer.c_last_name",
                                                        "date_dim.d_year"
                                                    ],
                                                    "Sort Method": "external merge",
                                                    "Sort Space Used": 32448,
                                                    "Sort Space Type": "Disk",
                                                    "Workers": [
                                                        {
                                                            "Worker Number": 0,
                                                            "Sort Method": "external merge",
                                                            "Sort Space Used": 31528,
                                                            "Sort Space Type": "Disk"
                                                        },
                                                        {
                                                            "Worker Number": 1,
                                                            "Sort Method": "external merge",
                                                            "Sort Space Used": 31576,
                                                            "Sort Space Type": "Disk"
                                                        }
                                                    ],
                                                    "Plans": [
                                                        {
                                                            "Node Type": "Nested Loop",
                                                            "Parent Relationship": "Outer",
                                                            "Parallel Aware": false,
                                                            "Async Capable": false,
                                                            "Join Type": "Inner",
                                                            "Startup Cost": 1947.74,
                                                            "Total Cost": 72367.49,
                                                            "Plan Rows": 10863,
                                                            "Plan Width": 79,
                                                            "Actual Startup Time": 2.434,
                                                            "Actual Total Time": 468.954,
                                                            "Actual Rows": 357343,
                                                            "Actual Loops": 3,
                                                            "Inner Unique": true,
                                                            "Workers": [],
                                                            "Plans": [
                                                                {
                                                                    "Node Type": "Hash Join",
                                                                    "Parent Relationship": "Outer",
                                                                    "Parallel Aware": true,
                                                                    "Async Capable": false,
                                                                    "Join Type": "Inner",
                                                                    "Startup Cost": 1947.45,
                                                                    "Total Cost": 68795.67,
                                                                    "Plan Rows": 11367,
                                                                    "Plan Width": 14,
                                                                    "Actual Startup Time": 2.378,
                                                                    "Actual Total Time": 168.835,
                                                                    "Actual Rows": 366001,
                                                                    "Actual Loops": 3,
                                                                    "Inner Unique": true,
                                                                    "Hash Cond": "(store_sales.ss_sold_date_sk = date_dim.d_date_sk)",
                                                                    "Workers": [],
                                                                    "Plans": [
                                                                        {
                                                                            "Node Type": "Seq Scan",
                                                                            "Parent Relationship": "Outer",
                                                                            "Parallel Aware": true,
                                                                            "Async Capable": false,
                                                                            "Relation Name": "store_sales",
                                                                            "Alias": "store_sales",
                                                                            "Startup Cost": 0.0,
                                                                            "Total Cost": 63697.62,
                                                                            "Plan Rows": 1200162,
                                                                            "Plan Width": 14,
                                                                            "Actual Startup Time": 0.022,
                                                                            "Actual Total Time": 67.1,
                                                                            "Actual Rows": 960135,
                                                                            "Actual Loops": 3,
                                                                            "Workers": []
                                                                        },
                                                                        {
                                                                            "Node Type": "Hash",
                                                                            "Parent Relationship": "Inner",
                                                                            "Parallel Aware": true,
                                                                            "Async Capable": false,
                                                                            "Startup Cost": 1942.12,
                                                                            "Total Cost": 1942.12,
                                                                            "Plan Rows": 426,
                                                                            "Plan Width": 8,
                                                                            "Actual Startup Time": 2.319,
                                                                            "Actual Total Time": 2.319,
                                                                            "Actual Rows": 244,
                                                                            "Actual Loops": 3,
                                                                            "Hash Buckets": 1024,
                                                                            "Original Hash Buckets": 1024,
                                                                            "Hash Batches": 1,
                                                                            "Original Hash Batches": 1,
                                                                            "Peak Memory Usage": 104,
                                                                            "Workers": [],
                                                                            "Plans": [
                                                                                {
                                                                                    "Node Type": "Seq Scan",
                                                                                    "Parent Relationship": "Outer",
                                                                                    "Parallel Aware": true,
                                                                                    "Async Capable": false,
                                                                                    "Relation Name": "date_dim",
                                                                                    "Alias": "date_dim",
                                                                                    "Startup Cost": 0.0,
                                                                                    "Total Cost": 1942.12,
                                                                                    "Plan Rows": 426,
                                                                                    "Plan Width": 8,
                                                                                    "Actual Startup Time": 1.139,
                                                                                    "Actual Total Time": 2.232,
                                                                                    "Actual Rows": 244,
                                                                                    "Actual Loops": 3,
                                                                                    "Filter": "(d_year = ANY ('{1999,2000}'::integer[]))",
                                                                                    "Rows Removed by Filter": 24106,
                                                                                    "Workers": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "Node Type": "Index Scan",
                                                                    "Parent Relationship": "Inner",
                                                                    "Parallel Aware": false,
                                                                    "Async Capable": false,
                                                                    "Scan Direction": "Forward",
                                                                    "Index Name": "customer_pkey",
                                                                    "Relation Name": "customer",
                                                                    "Alias": "customer",
                                                                    "Startup Cost": 0.29,
                                                                    "Total Cost": 0.31,
                                                                    "Plan Rows": 1,
                                                                    "Plan Width": 73,
                                                                    "Actual Startup Time": 0.001,
                                                                    "Actual Total Time": 0.001,
                                                                    "Actual Rows": 1,
                                                                    "Actual Loops": 1098002,
                                                                    "Index Cond": "(c_customer_sk = store_sales.ss_customer_sk)",
                                                                    "Rows Removed by Index Recheck": 0,
                                                                    "Workers": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "Node Type": "Aggregate",
                            "Strategy": "Sorted",
                            "Partial Mode": "Finalize",
                            "Parent Relationship": "Member",
                            "Parallel Aware": false,
                            "Async Capable": false,
                            "Startup Cost": 26640.6,
                            "Total Cost": 27545.4,
                            "Plan Rows": 7124,
                            "Plan Width": 137,
                            "Actual Startup Time": 469.802,
                            "Actual Total Time": 619.449,
                            "Actual Rows": 22409,
                            "Actual Loops": 1,
                            "Group Key": [
                                "customer_1.c_customer_id",
                                "customer_1.c_first_name",
                                "customer_1.c_last_name",
                                "date_dim_1.d_year"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Gather Merge",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Async Capable": false,
                                    "Startup Cost": 26640.6,
                                    "Total Cost": 27399.96,
                                    "Plan Rows": 5936,
                                    "Plan Width": 105,
                                    "Actual Startup Time": 469.798,
                                    "Actual Total Time": 613.457,
                                    "Actual Rows": 23888,
                                    "Actual Loops": 1,
                                    "Workers Planned": 2,
                                    "Workers Launched": 2,
                                    "Plans": [
                                        {
                                            "Node Type": "Aggregate",
                                            "Strategy": "Sorted",
                                            "Partial Mode": "Partial",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Async Capable": false,
                                            "Startup Cost": 25640.58,
                                            "Total Cost": 25714.78,
                                            "Plan Rows": 2968,
                                            "Plan Width": 105,
                                            "Actual Startup Time": 464.917,
                                            "Actual Total Time": 578.693,
                                            "Actual Rows": 7963,
                                            "Actual Loops": 3,
                                            "Group Key": [
                                                "customer_1.c_customer_id",
                                                "customer_1.c_first_name",
                                                "customer_1.c_last_name",
                                                "date_dim_1.d_year"
                                            ],
                                            "Workers": [],
                                            "Plans": [
                                                {
                                                    "Node Type": "Sort",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Async Capable": false,
                                                    "Startup Cost": 25640.58,
                                                    "Total Cost": 25648.0,
                                                    "Plan Rows": 2968,
                                                    "Plan Width": 79,
                                                    "Actual Startup Time": 464.888,
                                                    "Actual Total Time": 562.315,
                                                    "Actual Rows": 95002,
                                                    "Actual Loops": 3,
                                                    "Sort Key": [
                                                        "customer_1.c_customer_id",
                                                        "customer_1.c_first_name",
                                                        "customer_1.c_last_name",
                                                        "date_dim_1.d_year"
                                                    ],
                                                    "Sort Method": "external merge",
                                                    "Sort Space Used": 8552,
                                                    "Sort Space Type": "Disk",
                                                    "Workers": [
                                                        {
                                                            "Worker Number": 0,
                                                            "Sort Method": "external merge",
                                                            "Sort Space Used": 8472,
                                                            "Sort Space Type": "Disk"
                                                        },
                                                        {
                                                            "Worker Number": 1,
                                                            "Sort Method": "external merge",
                                                            "Sort Space Used": 8408,
                                                            "Sort Space Type": "Disk"
                                                        }
                                                    ],
                                                    "Plans": [
                                                        {
                                                            "Node Type": "Nested Loop",
                                                            "Parent Relationship": "Outer",
                                                            "Parallel Aware": false,
                                                            "Async Capable": false,
                                                            "Join Type": "Inner",
                                                            "Startup Cost": 1947.74,
                                                            "Total Cost": 25469.4,
                                                            "Plan Rows": 2968,
                                                            "Plan Width": 79,
                                                            "Actual Startup Time": 2.092,
                                                            "Actual Total Time": 144.501,
                                                            "Actual Rows": 95002,
                                                            "Actual Loops": 3,
                                                            "Inner Unique": true,
                                                            "Workers": [],
                                                            "Plans": [
                                                                {
                                                                    "Node Type": "Hash Join",
                                                                    "Parent Relationship": "Outer",
                                                                    "Parallel Aware": true,
                                                                    "Async Capable": false,
                                                                    "Join Type": "Inner",
                                                                    "Startup Cost": 1947.45,
                                                                    "Total Cost": 24498.75,
                                                                    "Plan Rows": 2969,
                                                                    "Plan Width": 14,
                                                                    "Actual Startup Time": 2.071,
                                                                    "Actual Total Time": 55.331,
                                                                    "Actual Rows": 95013,
                                                                    "Actual Loops": 3,
                                                                    "Inner Unique": true,
                                                                    "Hash Cond": "(web_sales.ws_sold_date_sk = date_dim_1.d_date_sk)",
                                                                    "Workers": [],
                                                                    "Plans": [
                                                                        {
                                                                            "Node Type": "Seq Scan",
                                                                            "Parent Relationship": "Outer",
                                                                            "Parallel Aware": true,
                                                                            "Async Capable": false,
                                                                            "Relation Name": "web_sales",
                                                                            "Alias": "web_sales",
                                                                            "Startup Cost": 0.0,
                                                                            "Total Cost": 21764.43,
                                                                            "Plan Rows": 299743,
                                                                            "Plan Width": 14,
                                                                            "Actual Startup Time": 0.034,
                                                                            "Actual Total Time": 25.387,
                                                                            "Actual Rows": 239795,
                                                                            "Actual Loops": 3,
                                                                            "Workers": []
                                                                        },
                                                                        {
                                                                            "Node Type": "Hash",
                                                                            "Parent Relationship": "Inner",
                                                                            "Parallel Aware": true,
                                                                            "Async Capable": false,
                                                                            "Startup Cost": 1942.12,
                                                                            "Total Cost": 1942.12,
                                                                            "Plan Rows": 426,
                                                                            "Plan Width": 8,
                                                                            "Actual Startup Time": 1.991,
                                                                            "Actual Total Time": 1.992,
                                                                            "Actual Rows": 244,
                                                                            "Actual Loops": 3,
                                                                            "Hash Buckets": 1024,
                                                                            "Original Hash Buckets": 1024,
                                                                            "Hash Batches": 1,
                                                                            "Original Hash Batches": 1,
                                                                            "Peak Memory Usage": 104,
                                                                            "Workers": [],
                                                                            "Plans": [
                                                                                {
                                                                                    "Node Type": "Seq Scan",
                                                                                    "Parent Relationship": "Outer",
                                                                                    "Parallel Aware": true,
                                                                                    "Async Capable": false,
                                                                                    "Relation Name": "date_dim",
                                                                                    "Alias": "date_dim_1",
                                                                                    "Startup Cost": 0.0,
                                                                                    "Total Cost": 1942.12,
                                                                                    "Plan Rows": 426,
                                                                                    "Plan Width": 8,
                                                                                    "Actual Startup Time": 0.888,
                                                                                    "Actual Total Time": 1.898,
                                                                                    "Actual Rows": 244,
                                                                                    "Actual Loops": 3,
                                                                                    "Filter": "(d_year = ANY ('{1999,2000}'::integer[]))",
                                                                                    "Rows Removed by Filter": 24106,
                                                                                    "Workers": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "Node Type": "Index Scan",
                                                                    "Parent Relationship": "Inner",
                                                                    "Parallel Aware": false,
                                                                    "Async Capable": false,
                                                                    "Scan Direction": "Forward",
                                                                    "Index Name": "customer_pkey",
                                                                    "Relation Name": "customer",
                                                                    "Alias": "customer_1",
                                                                    "Startup Cost": 0.29,
                                                                    "Total Cost": 0.33,
                                                                    "Plan Rows": 1,
                                                                    "Plan Width": 73,
                                                                    "Actual Startup Time": 0.001,
                                                                    "Actual Total Time": 0.001,
                                                                    "Actual Rows": 1,
                                                                    "Actual Loops": 285039,
                                                                    "Index Cond": "(c_customer_sk = web_sales.ws_bill_customer_sk)",
                                                                    "Rows Removed by Index Recheck": 0,
                                                                    "Workers": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Sort",
                    "Parent Relationship": "Outer",
                    "Parallel Aware": false,
                    "Async Capable": false,
                    "Startup Cost": 3485.54,
                    "Total Cost": 3485.54,
                    "Plan Rows": 1,
                    "Plan Width": 276,
                    "Actual Startup Time": 576131.635,
                    "Actual Total Time": 576131.638,
                    "Actual Rows": 100,
                    "Actual Loops": 1,
                    "Sort Key": [
                        "t_s_secyear.customer_id",
                        "t_s_secyear.customer_last_name",
                        "t_s_secyear.customer_first_name"
                    ],
                    "Sort Method": "quicksort",
                    "Sort Space Used": 39,
                    "Sort Space Type": "Memory",
                    "Plans": [
                        {
                            "Node Type": "Nested Loop",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Async Capable": false,
                            "Join Type": "Inner",
                            "Startup Cost": 0.0,
                            "Total Cost": 3485.53,
                            "Plan Rows": 1,
                            "Plan Width": 276,
                            "Actual Startup Time": 8317.672,
                            "Actual Total Time": 576131.356,
                            "Actual Rows": 105,
                            "Actual Loops": 1,
                            "Inner Unique": false,
                            "Join Filter": "((t_s_secyear.customer_id = t_w_secyear.customer_id) AND (CASE WHEN (t_w_firstyear.year_total > '0'::numeric) THEN (t_w_secyear.year_total / t_w_firstyear.year_total) ELSE NULL::numeric END > CASE WHEN (t_s_firstyear.year_total > '0'::numeric) THEN (t_s_secyear.year_total / t_s_firstyear.year_total) ELSE NULL::numeric END))",
                            "Rows Removed by Join Filter": 17677400,
                            "Plans": [
                                {
                                    "Node Type": "Nested Loop",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Async Capable": false,
                                    "Join Type": "Inner",
                                    "Startup Cost": 0.0,
                                    "Total Cost": 2655.62,
                                    "Plan Rows": 1,
                                    "Plan Width": 508,
                                    "Actual Startup Time": 3166.999,
                                    "Actual Total Time": 562254.53,
                                    "Actual Rows": 1585,
                                    "Actual Loops": 1,
                                    "Inner Unique": false,
                                    "Join Filter": "(t_s_secyear.customer_id = t_w_firstyear.customer_id)",
                                    "Rows Removed by Join Filter": 163266695,
                                    "Plans": [
                                        {
                                            "Node Type": "Nested Loop",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Async Capable": false,
                                            "Join Type": "Inner",
                                            "Startup Cost": 0.0,
                                            "Total Cost": 1742.75,
                                            "Plan Rows": 1,
                                            "Plan Width": 408,
                                            "Actual Startup Time": 2931.186,
                                            "Actual Total Time": 394385.069,
                                            "Actual Rows": 14505,
                                            "Actual Loops": 1,
                                            "Inner Unique": false,
                                            "Join Filter": "(t_s_firstyear.customer_id = t_s_secyear.customer_id)",
                                            "Rows Removed by Join Filter": 1442391911,
                                            "Plans": [
                                                {
                                                    "Node Type": "CTE Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Async Capable": false,
                                                    "CTE Name": "year_total",
                                                    "Alias": "t_s_firstyear",
                                                    "Startup Cost": 0.0,
                                                    "Total Cost": 912.86,
                                                    "Plan Rows": 1,
                                                    "Plan Width": 100,
                                                    "Actual Startup Time": 1658.279,
                                                    "Actual Total Time": 1770.471,
                                                    "Actual Rows": 37708,
                                                    "Actual Loops": 1,
                                                    "Filter": "((year_total > '0'::numeric) AND (sale_type = 's'::text) AND (year = 1999))",
                                                    "Rows Removed by Filter": 60661
                                                },
                                                {
                                                    "Node Type": "CTE Scan",
                                                    "Parent Relationship": "Inner",
                                                    "Parallel Aware": false,
                                                    "Async Capable": false,
                                                    "CTE Name": "year_total",
                                                    "Alias": "t_s_secyear",
                                                    "Startup Cost": 0.0,
                                                    "Total Cost": 829.88,
                                                    "Plan Rows": 1,
                                                    "Plan Width": 308,
                                                    "Actual Startup Time": 0.002,
                                                    "Actual Total Time": 9.272,
                                                    "Actual Rows": 38252,
                                                    "Actual Loops": 37708,
                                                    "Filter": "((sale_type = 's'::text) AND (year = 2000))",
                                                    "Rows Removed by Filter": 60117
                                                }
                                            ]
                                        },
                                        {
                                            "Node Type": "CTE Scan",
                                            "Parent Relationship": "Inner",
                                            "Parallel Aware": false,
                                            "Async Capable": false,
                                            "CTE Name": "year_total",
                                            "Alias": "t_w_firstyear",
                                            "Startup Cost": 0.0,
                                            "Total Cost": 912.86,
                                            "Plan Rows": 1,
                                            "Plan Width": 100,
                                            "Actual Startup Time": 8.427,
                                            "Actual Total Time": 11.239,
                                            "Actual Rows": 11256,
                                            "Actual Loops": 14505,
                                            "Filter": "((year_total > '0'::numeric) AND (sale_type = 'w'::text) AND (year = 1999))",
                                            "Rows Removed by Filter": 87113
                                        }
                                    ]
                                },
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Inner",
                                    "Parallel Aware": false,
                                    "Async Capable": false,
                                    "CTE Name": "year_total",
                                    "Alias": "t_w_secyear",
                                    "Startup Cost": 0.0,
                                    "Total Cost": 829.88,
                                    "Plan Rows": 1,
                                    "Plan Width": 100,
                                    "Actual Startup Time": 6.249,
                                    "Actual Total Time": 8.426,
                                    "Actual Rows": 11153,
                                    "Actual Loops": 1585,
                                    "Filter": "((sale_type = 'w'::text) AND (year = 2000))",
                                    "Rows Removed by Filter": 87216
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        "Planning Time": 0.361,
        "Triggers": [],
        "Execution Time": 576133.479
    }
]
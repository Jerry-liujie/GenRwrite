[{"Plan": {"Node Type": "Limit", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 309664.46, "Total Cost": 309664.47, "Plan Rows": 1, "Plan Width": 80, "Actual Startup Time": 862.43, "Actual Total Time": 865.079, "Actual Rows": 100, "Actual Loops": 1, "Plans": [{"Node Type": "Aggregate", "Strategy": "Sorted", "Partial Mode": "Simple", "Parent Relationship": "InitPlan", "Subplan Name": "CTE all_sales", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 283746.83, "Total Cost": 307440.84, "Plan Rows": 48603, "Plan Width": 60, "Actual Startup Time": 680.017, "Actual Total Time": 863.639, "Actual Rows": 5161, "Actual Loops": 1, "Group Key": ["date_dim.d_year", "item.i_brand_id", "item.i_class_id", "item.i_category_id", "item.i_manufact_id"], "Plans": [{"Node Type": "Unique", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 283746.83, "Total Cost": 293467.45, "Plan Rows": 486031, "Plan Width": 56, "Actual Startup Time": 679.966, "Actual Total Time": 819.331, "Actual Rows": 484968, "Actual Loops": 1, "Plans": [{"Node Type": "Sort", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 283746.83, "Total Cost": 284961.91, "Plan Rows": 486031, "Plan Width": 56, "Actual Startup Time": 679.965, "Actual Total Time": 767.945, "Actual Rows": 486567, "Actual Loops": 1, "Sort Key": ["date_dim.d_year", "item.i_brand_id", "item.i_class_id", "item.i_category_id", "item.i_manufact_id", "((store_sales.ss_quantity - COALESCE(store_returns.sr_return_quantity, 0)))", "((store_sales.ss_ext_sales_price - COALESCE(store_returns.sr_return_amt, 0.0)))"], "Sort Method": "external merge", "Sort Space Used": 19456, "Sort Space Type": "Disk", "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 7371.4, "Total Cost": 221225.03, "Plan Rows": 486031, "Plan Width": 56, "Actual Startup Time": 24.838, "Actual Total Time": 478.215, "Actual Rows": 486567, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Append", "Parent Relationship": "Outer", "Parallel Aware": true, "Async Capable": false, "Startup Cost": 6371.4, "Total Cost": 171621.93, "Plan Rows": 486031, "Plan Width": 56, "Actual Startup Time": 194.726, "Actual Total Time": 475.825, "Actual Rows": 162189, "Actual Loops": 3, "Workers": [], "Subplans Removed": 0, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Member", "Parallel Aware": true, "Async Capable": false, "Join Type": "Left", "Startup Cost": 12235.24, "Total Cost": 83038.57, "Plan Rows": 113605, "Plan Width": 56, "Actual Startup Time": 220.163, "Actual Total Time": 246.98, "Actual Rows": 91013, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "((store_sales.ss_ticket_number = store_returns.sr_ticket_number) AND (store_sales.ss_item_sk = store_returns.sr_item_sk))", "Workers": [], "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 3747.29, "Total Cost": 70908.17, "Plan Rows": 113605, "Plan Width": 38, "Actual Startup Time": 7.272, "Actual Total Time": 176.105, "Actual Rows": 91013, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(store_sales.ss_sold_date_sk = date_dim.d_date_sk)", "Workers": [], "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 1375.47, "Total Cost": 68224.26, "Plan Rows": 118883, "Plan Width": 38, "Actual Startup Time": 1.859, "Actual Total Time": 154.004, "Actual Rows": 95375, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(store_sales.ss_item_sk = item.i_item_sk)", "Workers": [], "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Async Capable": false, "Relation Name": "store_sales", "Alias": "store_sales", "Startup Cost": 0.0, "Total Cost": 63697.62, "Plan Rows": 1200162, "Plan Width": 22, "Actual Startup Time": 0.042, "Actual Total Time": 68.004, "Actual Rows": 960135, "Actual Loops": 3, "Workers": []}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Async Capable": false, "Startup Cost": 1362.35, "Total Cost": 1362.35, "Plan Rows": 1049, "Plan Width": 20, "Actual Startup Time": 1.785, "Actual Total Time": 1.786, "Actual Rows": 594, "Actual Loops": 3, "Hash Buckets": 2048, "Original Hash Buckets": 2048, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 144, "Workers": [], "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Async Capable": false, "Relation Name": "item", "Alias": "item", "Startup Cost": 0.0, "Total Cost": 1362.35, "Plan Rows": 1049, "Plan Width": 20, "Actual Startup Time": 0.015, "Actual Total Time": 5.134, "Actual Rows": 1783, "Actual Loops": 1, "Filter": "(i_category = 'Sports'::bpchar)", "Rows Removed by Filter": 16217, "Workers": []}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Async Capable": false, "Startup Cost": 1834.7, "Total Cost": 1834.7, "Plan Rows": 42970, "Plan Width": 8, "Actual Startup Time": 5.363, "Actual Total Time": 5.364, "Actual Rows": 24350, "Actual Loops": 3, "Hash Buckets": 131072, "Original Hash Buckets": 131072, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 3904, "Workers": [], "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Async Capable": false, "Relation Name": "date_dim", "Alias": "date_dim", "Startup Cost": 0.0, "Total Cost": 1834.7, "Plan Rows": 42970, "Plan Width": 8, "Actual Startup Time": 0.062, "Actual Total Time": 9.261, "Actual Rows": 73049, "Actual Loops": 1, "Workers": []}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Async Capable": false, "Startup Cost": 5988.98, "Total Cost": 5988.98, "Plan Rows": 119798, "Plan Width": 18, "Actual Startup Time": 22.295, "Actual Total Time": 22.295, "Actual Rows": 95838, "Actual Loops": 3, "Hash Buckets": 65536, "Original Hash Buckets": 65536, "Hash Batches": 8, "Original Hash Batches": 8, "Peak Memory Usage": 2496, "Workers": [], "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Async Capable": false, "Relation Name": "store_returns", "Alias": "store_returns", "Startup Cost": 0.0, "Total Cost": 5988.98, "Plan Rows": 119798, "Plan Width": 18, "Actual Startup Time": 0.028, "Actual Total Time": 29.371, "Actual Rows": 287514, "Actual Loops": 1, "Workers": []}]}]}, {"Node Type": "Hash Join", "Parent Relationship": "Member", "Parallel Aware": true, "Async Capable": false, "Join Type": "Left", "Startup Cost": 6371.4, "Total Cost": 53694.63, "Plan Rows": 59234, "Plan Width": 56, "Actual Startup Time": 25.399, "Actual Total Time": 233.465, "Actual Rows": 70940, "Actual Loops": 2, "Inner Unique": true, "Hash Cond": "((catalog_sales.cs_order_number = catalog_returns.cr_order_number) AND (catalog_sales.cs_item_sk = catalog_returns.cr_item_sk))", "Workers": [], "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 1375.77, "Total Cost": 48091.85, "Plan Rows": 59234, "Plan Width": 38, "Actual Startup Time": 2.456, "Actual Total Time": 184.238, "Actual Rows": 70940, "Actual Loops": 2, "Inner Unique": true, "Workers": [], "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 1375.47, "Total Cost": 46364.29, "Plan Rows": 59500, "Plan Width": 38, "Actual Startup Time": 2.425, "Actual Total Time": 170.113, "Actual Rows": 71312, "Actual Loops": 2, "Inner Unique": true, "Hash Cond": "(catalog_sales.cs_item_sk = item_1.i_item_sk)", "Workers": [], "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Async Capable": false, "Relation Name": "catalog_sales", "Alias": "catalog_sales", "Startup Cost": 0.0, "Total Cost": 43411.7, "Plan Rows": 600670, "Plan Width": 22, "Actual Startup Time": 0.035, "Actual Total Time": 69.978, "Actual Rows": 720774, "Actual Loops": 2, "Workers": []}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Async Capable": false, "Startup Cost": 1362.35, "Total Cost": 1362.35, "Plan Rows": 1049, "Plan Width": 20, "Actual Startup Time": 2.364, "Actual Total Time": 2.364, "Actual Rows": 892, "Actual Loops": 2, "Hash Buckets": 2048, "Original Hash Buckets": 2048, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 144, "Workers": [], "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Async Capable": false, "Relation Name": "item", "Alias": "item_1", "Startup Cost": 0.0, "Total Cost": 1362.35, "Plan Rows": 1049, "Plan Width": 20, "Actual Startup Time": 0.012, "Actual Total Time": 4.563, "Actual Rows": 1783, "Actual Loops": 1, "Filter": "(i_category = 'Sports'::bpchar)", "Rows Removed by Filter": 16217, "Workers": []}]}]}, {"Node Type": "Memoize", "Parent Relationship": "Inner", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 0.3, "Total Cost": 0.32, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 0.0, "Actual Total Time": 0.0, "Actual Rows": 1, "Actual Loops": 142623, "Cache Key": "catalog_sales.cs_sold_date_sk", "Cache Mode": "logical", "Cache Hits": 38538, "Cache Misses": 817, "Cache Evictions": 0, "Cache Overflows": 0, "Peak Memory Usage": 87, "Workers": [{"Worker Number": 0, "Cache Hits": 101650, "Cache Misses": 1618, "Cache Evictions": 0, "Cache Overflows": 0, "Peak Memory Usage": 171}], "Plans": [{"Node Type": "Index Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Scan Direction": "Forward", "Index Name": "date_dim_pkey", "Relation Name": "date_dim", "Alias": "date_dim_1", "Startup Cost": 0.29, "Total Cost": 0.31, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 1, "Actual Loops": 2435, "Index Cond": "(d_date_sk = catalog_sales.cs_sold_date_sk)", "Rows Removed by Index Recheck": 0, "Workers": []}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Async Capable": false, "Startup Cost": 3724.45, "Total Cost": 3724.45, "Plan Rows": 84745, "Plan Width": 18, "Actual Startup Time": 22.794, "Actual Total Time": 22.794, "Actual Rows": 72034, "Actual Loops": 2, "Hash Buckets": 262144, "Original Hash Buckets": 262144, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 9888, "Workers": [], "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Async Capable": false, "Relation Name": "catalog_returns", "Alias": "catalog_returns", "Startup Cost": 0.0, "Total Cost": 3724.45, "Plan Rows": 84745, "Plan Width": 18, "Actual Startup Time": 0.005, "Actual Total Time": 18.968, "Actual Rows": 144067, "Actual Loops": 1, "Workers": []}]}]}, {"Node Type": "Hash Join", "Parent Relationship": "Member", "Parallel Aware": true, "Async Capable": false, "Join Type": "Left", "Startup Cost": 3758.11, "Total Cost": 27598.26, "Plan Rows": 29675, "Plan Width": 56, "Actual Startup Time": 24.479, "Actual Total Time": 202.408, "Actual Rows": 71647, "Actual Loops": 1, "Inner Unique": true, "Hash Cond": "((web_sales.ws_order_number = web_returns.wr_order_number) AND (web_sales.ws_item_sk = web_returns.wr_item_sk))", "Workers": [], "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 1375.77, "Total Cost": 24911.75, "Plan Rows": 29675, "Plan Width": 38, "Actual Startup Time": 5.706, "Actual Total Time": 159.947, "Actual Rows": 71647, "Actual Loops": 1, "Inner Unique": true, "Workers": [], "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 1375.47, "Total Cost": 23926.91, "Plan Rows": 29691, "Plan Width": 38, "Actual Startup Time": 5.692, "Actual Total Time": 141.049, "Actual Rows": 71661, "Actual Loops": 1, "Inner Unique": true, "Hash Cond": "(web_sales.ws_item_sk = item_2.i_item_sk)", "Workers": [], "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Async Capable": false, "Relation Name": "web_sales", "Alias": "web_sales", "Startup Cost": 0.0, "Total Cost": 21764.43, "Plan Rows": 299743, "Plan Width": 22, "Actual Startup Time": 0.006, "Actual Total Time": 65.959, "Actual Rows": 719384, "Actual Loops": 1, "Workers": []}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Async Capable": false, "Startup Cost": 1362.35, "Total Cost": 1362.35, "Plan Rows": 1049, "Plan Width": 20, "Actual Startup Time": 5.672, "Actual Total Time": 5.673, "Actual Rows": 1783, "Actual Loops": 1, "Hash Buckets": 2048, "Original Hash Buckets": 2048, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 144, "Workers": [], "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Async Capable": false, "Relation Name": "item", "Alias": "item_2", "Startup Cost": 0.0, "Total Cost": 1362.35, "Plan Rows": 1049, "Plan Width": 20, "Actual Startup Time": 0.013, "Actual Total Time": 5.47, "Actual Rows": 1783, "Actual Loops": 1, "Filter": "(i_category = 'Sports'::bpchar)", "Rows Removed by Filter": 16217, "Workers": []}]}]}, {"Node Type": "Memoize", "Parent Relationship": "Inner", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 0.3, "Total Cost": 0.33, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 0.0, "Actual Total Time": 0.0, "Actual Rows": 1, "Actual Loops": 71661, "Cache Key": "web_sales.ws_sold_date_sk", "Cache Mode": "logical", "Cache Hits": 69837, "Cache Misses": 1824, "Cache Evictions": 0, "Cache Overflows": 0, "Peak Memory Usage": 193, "Workers": [], "Plans": [{"Node Type": "Index Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Scan Direction": "Forward", "Index Name": "date_dim_pkey", "Relation Name": "date_dim", "Alias": "date_dim_2", "Startup Cost": 0.29, "Total Cost": 0.32, "Plan Rows": 1, "Plan Width": 8, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 1, "Actual Loops": 1824, "Index Cond": "(d_date_sk = web_sales.ws_sold_date_sk)", "Rows Removed by Index Recheck": 0, "Workers": []}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Async Capable": false, "Startup Cost": 1749.14, "Total Cost": 1749.14, "Plan Rows": 42214, "Plan Width": 18, "Actual Startup Time": 18.642, "Actual Total Time": 18.642, "Actual Rows": 71763, "Actual Loops": 1, "Hash Buckets": 131072, "Original Hash Buckets": 131072, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 4928, "Workers": [], "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Async Capable": false, "Relation Name": "web_returns", "Alias": "web_returns", "Startup Cost": 0.0, "Total Cost": 1749.14, "Plan Rows": 42214, "Plan Width": 18, "Actual Startup Time": 0.008, "Actual Total Time": 8.557, "Actual Rows": 71763, "Actual Loops": 1, "Workers": []}]}]}]}]}]}]}]}, {"Node Type": "Sort", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 2223.62, "Total Cost": 2223.63, "Plan Rows": 1, "Plan Width": 80, "Actual Startup Time": 862.429, "Actual Total Time": 862.432, "Actual Rows": 100, "Actual Loops": 1, "Sort Key": ["((curr_yr.sales_cnt - prev_yr.sales_cnt))", "((curr_yr.sales_amt - prev_yr.sales_amt))"], "Sort Method": "quicksort", "Sort Space Used": 44, "Sort Space Type": "Memory", "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 1098.43, "Total Cost": 2223.61, "Plan Rows": 1, "Plan Width": 80, "Actual Startup Time": 862.117, "Actual Total Time": 862.402, "Actual Rows": 141, "Actual Loops": 1, "Inner Unique": false, "Hash Cond": "((curr_yr.i_brand_id = prev_yr.i_brand_id) AND (curr_yr.i_class_id = prev_yr.i_class_id) AND (curr_yr.i_category_id = prev_yr.i_category_id) AND (curr_yr.i_manufact_id = prev_yr.i_manufact_id))", "Join Filter": "(((curr_yr.sales_cnt)::numeric(17,2) / (prev_yr.sales_cnt)::numeric(17,2)) < 0.9)", "Rows Removed by Join Filter": 454, "Plans": [{"Node Type": "CTE Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "CTE Name": "all_sales", "Alias": "curr_yr", "Startup Cost": 0.0, "Total Cost": 1093.57, "Plan Rows": 243, "Plan Width": 60, "Actual Startup Time": 825.288, "Actual Total Time": 825.35, "Actual Rows": 885, "Actual Loops": 1, "Filter": "(d_year = 2002)", "Rows Removed by Filter": 4276}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 1093.57, "Total Cost": 1093.57, "Plan Rows": 243, "Plan Width": 60, "Actual Startup Time": 36.798, "Actual Total Time": 36.798, "Actual Rows": 872, "Actual Loops": 1, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 73, "Plans": [{"Node Type": "CTE Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "CTE Name": "all_sales", "Alias": "prev_yr", "Startup Cost": 0.0, "Total Cost": 1093.57, "Plan Rows": 243, "Plan Width": 60, "Actual Startup Time": 0.095, "Actual Total Time": 36.715, "Actual Rows": 873, "Actual Loops": 1, "Filter": "(d_year = 2001)", "Rows Removed by Filter": 4288}]}]}]}]}, "Planning Time": 0.811, "Triggers": [], "Execution Time": 866.754}]
[{"Plan": {"Node Type": "Limit", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 52314.53, "Total Cost": 52314.6, "Plan Rows": 27, "Plan Width": 17, "Actual Startup Time": 119129.045, "Actual Total Time": 119129.169, "Actual Rows": 100, "Actual Loops": 1, "Plans": [{"Node Type": "Aggregate", "Strategy": "Sorted", "Partial Mode": "Finalize", "Parent Relationship": "InitPlan", "Subplan Name": "CTE customer_total_return", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 9274.53, "Total Cost": 9448.35, "Plan Rows": 1375, "Plan Width": 40, "Actual Startup Time": 20.174, "Actual Total Time": 48.145, "Actual Rows": 50441, "Actual Loops": 1, "Group Key": ["store_returns.sr_customer_sk", "store_returns.sr_store_sk"], "Plans": [{"Node Type": "Gather Merge", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 9274.53, "Total Cost": 9419.7, "Plan Rows": 1146, "Plan Width": 40, "Actual Startup Time": 20.17, "Actual Total Time": 30.738, "Actual Rows": 51953, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Plans": [{"Node Type": "Aggregate", "Strategy": "Sorted", "Partial Mode": "Partial", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 8274.5, "Total Cost": 8287.4, "Plan Rows": 573, "Plan Width": 40, "Actual Startup Time": 18.542, "Actual Total Time": 24.397, "Actual Rows": 17318, "Actual Loops": 3, "Group Key": ["store_returns.sr_customer_sk", "store_returns.sr_store_sk"], "Workers": [], "Plans": [{"Node Type": "Sort", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 8274.5, "Total Cost": 8275.94, "Plan Rows": 573, "Plan Width": 14, "Actual Startup Time": 18.53, "Actual Total Time": 19.044, "Actual Rows": 18607, "Actual Loops": 3, "Sort Key": ["store_returns.sr_customer_sk", "store_returns.sr_store_sk"], "Sort Method": "quicksort", "Sort Space Used": 1659, "Sort Space Type": "Memory", "Workers": [{"Worker Number": 0, "Sort Method": "quicksort", "Sort Space Used": 1632, "Sort Space Type": "Memory"}, {"Worker Number": 1, "Sort Method": "quicksort", "Sort Space Used": 1627, "Sort Space Type": "Memory"}], "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": true, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 1944.79, "Total Cost": 8248.25, "Plan Rows": 573, "Plan Width": 14, "Actual Startup Time": 1.723, "Actual Total Time": 15.562, "Actual Rows": 18607, "Actual Loops": 3, "Inner Unique": true, "Hash Cond": "(store_returns.sr_returned_date_sk = date_dim.d_date_sk)", "Workers": [], "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Async Capable": false, "Relation Name": "store_returns", "Alias": "store_returns", "Startup Cost": 0.0, "Total Cost": 5988.98, "Plan Rows": 119798, "Plan Width": 18, "Actual Startup Time": 0.041, "Actual Total Time": 5.717, "Actual Rows": 95838, "Actual Loops": 3, "Workers": []}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": true, "Async Capable": false, "Startup Cost": 1942.12, "Total Cost": 1942.12, "Plan Rows": 213, "Plan Width": 4, "Actual Startup Time": 1.646, "Actual Total Time": 1.646, "Actual Rows": 122, "Actual Loops": 3, "Hash Buckets": 1024, "Original Hash Buckets": 1024, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 40, "Workers": [], "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Async Capable": false, "Relation Name": "date_dim", "Alias": "date_dim", "Startup Cost": 0.0, "Total Cost": 1942.12, "Plan Rows": 213, "Plan Width": 4, "Actual Startup Time": 1.26, "Actual Total Time": 1.618, "Actual Rows": 122, "Actual Loops": 3, "Filter": "(d_year = 2000)", "Rows Removed by Filter": 24228, "Workers": []}]}]}]}]}]}]}, {"Node Type": "Sort", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 42866.19, "Total Cost": 42866.25, "Plan Rows": 27, "Plan Width": 17, "Actual Startup Time": 119129.045, "Actual Total Time": 119129.047, "Actual Rows": 100, "Actual Loops": 1, "Sort Key": ["customer.c_customer_id"], "Sort Method": "top-N heapsort", "Sort Space Used": 37, "Sort Space Type": "Memory", "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 0.29, "Total Cost": 42865.54, "Plan Rows": 27, "Plan Width": 17, "Actual Startup Time": 56.95, "Actual Total Time": 119068.516, "Actual Rows": 18976, "Actual Loops": 1, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 0.0, "Total Cost": 42698.0, "Plan Rows": 27, "Plan Width": 4, "Actual Startup Time": 56.939, "Actual Total Time": 118964.841, "Actual Rows": 18982, "Actual Loops": 1, "Inner Unique": true, "Join Filter": "(ctr1.ctr_store_sk = store.s_store_sk)", "Rows Removed by Join Filter": 82029, "Plans": [{"Node Type": "CTE Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "CTE Name": "customer_total_return", "Alias": "ctr1", "Startup Cost": 0.0, "Total Cost": 42614.69, "Plan Rows": 458, "Plan Width": 8, "Actual Startup Time": 56.917, "Actual Total Time": 118945.787, "Actual Rows": 18982, "Actual Loops": 1, "Filter": "(ctr_total_return > (SubPlan 2))", "Rows Removed by Filter": 31459, "Plans": [{"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Simple", "Parent Relationship": "SubPlan", "Subplan Name": "SubPlan 2", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 30.96, "Total Cost": 30.97, "Plan Rows": 1, "Plan Width": 32, "Actual Startup Time": 2.357, "Actual Total Time": 2.357, "Actual Rows": 1, "Actual Loops": 50441, "Plans": [{"Node Type": "CTE Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "CTE Name": "customer_total_return", "Alias": "ctr2", "Startup Cost": 0.0, "Total Cost": 30.94, "Plan Rows": 7, "Plan Width": 32, "Actual Startup Time": 0.017, "Actual Total Time": 1.958, "Actual Rows": 8241, "Actual Loops": 50441, "Filter": "(ctr1.ctr_store_sk = ctr_store_sk)", "Rows Removed by Filter": 42200}]}]}, {"Node Type": "Materialize", "Parent Relationship": "Inner", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 0.0, "Total Cost": 1.21, "Plan Rows": 12, "Plan Width": 4, "Actual Startup Time": 0.0, "Actual Total Time": 0.0, "Actual Rows": 5, "Actual Loops": 18982, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Relation Name": "store", "Alias": "store", "Startup Cost": 0.0, "Total Cost": 1.15, "Plan Rows": 12, "Plan Width": 4, "Actual Startup Time": 0.013, "Actual Total Time": 0.015, "Actual Rows": 10, "Actual Loops": 1, "Filter": "(s_state = 'TN'::bpchar)", "Rows Removed by Filter": 0}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Async Capable": false, "Scan Direction": "Forward", "Index Name": "customer_pkey", "Relation Name": "customer", "Alias": "customer", "Startup Cost": 0.29, "Total Cost": 6.21, "Plan Rows": 1, "Plan Width": 21, "Actual Startup Time": 0.004, "Actual Total Time": 0.004, "Actual Rows": 1, "Actual Loops": 18982, "Index Cond": "(c_customer_sk = ctr1.ctr_customer_sk)", "Rows Removed by Index Recheck": 0}]}]}]}, "Planning Time": 0.19, "Triggers": [], "Execution Time": 119129.582}]
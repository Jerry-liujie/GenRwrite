[{"Plan": {"Node Type": "Sort", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 693969.57, "Total Cost": 693969.58, "Plan Rows": 1, "Plan Width": 210, "Actual Startup Time": 6897.395, "Actual Total Time": 6897.4, "Actual Rows": 43, "Actual Loops": 1, "Sort Key": ["((ss3.store_sales / ss2.store_sales))"], "Sort Method": "quicksort", "Sort Space Used": 31, "Sort Space Type": "Memory", "Plans": [{"Node Type": "Aggregate", "Strategy": "Hashed", "Partial Mode": "Simple", "Parent Relationship": "InitPlan", "Subplan Name": "CTE ss", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 351895.8, "Total Cost": 406368.94, "Plan Rows": 1484184, "Plan Width": 54, "Actual Startup Time": 1509.63, "Actual Total Time": 1755.293, "Actual Rows": 35136, "Actual Loops": 1, "Group Key": ["customer_address.ca_county", "date_dim.d_qoy", "date_dim.d_year"], "Planned Partitions": 128, "HashAgg Batches": 129, "Peak Memory Usage": 4305, "Disk Usage": 122376, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 5617.6, "Total Cost": 129391.84, "Plan Rows": 2627353, "Plan Width": 28, "Actual Startup Time": 20.819, "Actual Total Time": 1038.898, "Actual Rows": 2685273, "Actual Loops": 1, "Inner Unique": true, "Hash Cond": "(store_sales.ss_addr_sk = customer_address.ca_address_sk)", "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 3405.6, "Total Cost": 119953.94, "Plan Rows": 2752500, "Plan Width": 18, "Actual Startup Time": 13.577, "Actual Total Time": 760.812, "Actual Rows": 2750311, "Actual Loops": 1, "Inner Unique": true, "Hash Cond": "(store_sales.ss_sold_date_sk = date_dim.d_date_sk)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Relation Name": "store_sales", "Alias": "store_sales", "Startup Cost": 0.0, "Total Cost": 80499.89, "Plan Rows": 2880389, "Plan Width": 14, "Actual Startup Time": 0.008, "Actual Total Time": 353.632, "Actual Rows": 2880404, "Actual Loops": 1}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 2135.49, "Total Cost": 2135.49, "Plan Rows": 73049, "Plan Width": 12, "Actual Startup Time": 13.372, "Actual Total Time": 13.373, "Actual Rows": 73049, "Actual Loops": 1, "Hash Buckets": 131072, "Original Hash Buckets": 131072, "Hash Batches": 2, "Original Hash Batches": 2, "Peak Memory Usage": 2593, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Relation Name": "date_dim", "Alias": "date_dim", "Startup Cost": 0.0, "Total Cost": 2135.49, "Plan Rows": 73049, "Plan Width": 12, "Actual Startup Time": 0.007, "Actual Total Time": 5.859, "Actual Rows": 73049, "Actual Loops": 1}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 1587.0, "Total Cost": 1587.0, "Plan Rows": 50000, "Plan Width": 18, "Actual Startup Time": 7.228, "Actual Total Time": 7.228, "Actual Rows": 50000, "Actual Loops": 1, "Hash Buckets": 65536, "Original Hash Buckets": 65536, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 3052, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Relation Name": "customer_address", "Alias": "customer_address", "Startup Cost": 0.0, "Total Cost": 1587.0, "Plan Rows": 50000, "Plan Width": 18, "Actual Startup Time": 0.01, "Actual Total Time": 3.737, "Actual Rows": 50000, "Actual Loops": 1}]}]}]}, {"Node Type": "Aggregate", "Strategy": "Hashed", "Partial Mode": "Simple", "Parent Relationship": "InitPlan", "Subplan Name": "CTE ws", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 103585.12, "Total Cost": 122389.53, "Plan Rows": 718497, "Plan Width": 54, "Actual Startup Time": 437.739, "Actual Total Time": 497.566, "Actual Rows": 23320, "Actual Loops": 1, "Group Key": ["customer_address_1.ca_county", "date_dim_1.d_qoy", "date_dim_1.d_year"], "Planned Partitions": 64, "HashAgg Batches": 65, "Peak Memory Usage": 4241, "Disk Usage": 28464, "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 5617.6, "Total Cost": 42737.4, "Plan Rows": 718497, "Plan Width": 28, "Actual Startup Time": 23.78, "Actual Total Time": 312.146, "Actual Rows": 719118, "Actual Loops": 1, "Inner Unique": true, "Hash Cond": "(web_sales.ws_bill_addr_sk = customer_address_1.ca_address_sk)", "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 3405.6, "Total Cost": 38637.94, "Plan Rows": 718976, "Plan Width": 18, "Actual Startup Time": 16.481, "Actual Total Time": 233.337, "Actual Rows": 719195, "Actual Loops": 1, "Inner Unique": true, "Hash Cond": "(web_sales.ws_sold_date_sk = date_dim_1.d_date_sk)", "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Relation Name": "web_sales", "Alias": "web_sales", "Startup Cost": 0.0, "Total Cost": 25960.84, "Plan Rows": 719384, "Plan Width": 14, "Actual Startup Time": 0.015, "Actual Total Time": 111.933, "Actual Rows": 719384, "Actual Loops": 1}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 2135.49, "Total Cost": 2135.49, "Plan Rows": 73049, "Plan Width": 12, "Actual Startup Time": 16.267, "Actual Total Time": 16.267, "Actual Rows": 73049, "Actual Loops": 1, "Hash Buckets": 131072, "Original Hash Buckets": 131072, "Hash Batches": 2, "Original Hash Batches": 2, "Peak Memory Usage": 2593, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Relation Name": "date_dim", "Alias": "date_dim_1", "Startup Cost": 0.0, "Total Cost": 2135.49, "Plan Rows": 73049, "Plan Width": 12, "Actual Startup Time": 0.006, "Actual Total Time": 8.356, "Actual Rows": 73049, "Actual Loops": 1}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 1587.0, "Total Cost": 1587.0, "Plan Rows": 50000, "Plan Width": 18, "Actual Startup Time": 7.254, "Actual Total Time": 7.254, "Actual Rows": 50000, "Actual Loops": 1, "Hash Buckets": 65536, "Original Hash Buckets": 65536, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 3052, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Relation Name": "customer_address", "Alias": "customer_address_1", "Startup Cost": 0.0, "Total Cost": 1587.0, "Plan Rows": 50000, "Plan Width": 18, "Actual Startup Time": 0.005, "Actual Total Time": 3.795, "Actual Rows": 50000, "Actual Loops": 1}]}]}]}, {"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 0.0, "Total Cost": 165211.09, "Plan Rows": 1, "Plan Width": 210, "Actual Startup Time": 2316.574, "Actual Total Time": 6897.268, "Actual Rows": 43, "Actual Loops": 1, "Inner Unique": false, "Join Filter": "(((ss1.ca_county)::text = (ws2.ca_county)::text) AND (CASE WHEN (ws1.web_sales > '0'::numeric) THEN (ws2.web_sales / ws1.web_sales) ELSE NULL::numeric END > CASE WHEN (ss1.store_sales > '0'::numeric) THEN (ss2.store_sales / ss1.store_sales) ELSE NULL::numeric END) AND (CASE WHEN (ws2.web_sales > '0'::numeric) THEN (ws3.web_sales / ws2.web_sales) ELSE NULL::numeric END > CASE WHEN (ss2.store_sales > '0'::numeric) THEN (ss3.store_sales / ss2.store_sales) ELSE NULL::numeric END))", "Rows Removed by Join Filter": 527207, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 0.0, "Total Cost": 147247.98, "Plan Rows": 1, "Plan Width": 554, "Actual Startup Time": 2097.248, "Actual Total Time": 6281.179, "Actual Rows": 570, "Actual Loops": 1, "Inner Unique": false, "Join Filter": "((ss1.ca_county)::text = (ss3.ca_county)::text)", "Rows Removed by Join Filter": 1038674, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 0.0, "Total Cost": 110142.92, "Plan Rows": 1, "Plan Width": 444, "Actual Startup Time": 2097.051, "Actual Total Time": 5172.851, "Actual Rows": 578, "Actual Loops": 1, "Inner Unique": false, "Join Filter": "((ss1.ca_county)::text = (ss2.ca_county)::text)", "Rows Removed by Join Filter": 1008217, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 0.0, "Total Cost": 73037.85, "Plan Rows": 1, "Plan Width": 334, "Actual Startup Time": 2096.94, "Actual Total Time": 4165.061, "Actual Rows": 617, "Actual Loops": 1, "Inner Unique": false, "Join Filter": "((ws1.ca_county)::text = (ss1.ca_county)::text)", "Rows Removed by Join Filter": 1089697, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 0.0, "Total Cost": 35931.96, "Plan Rows": 2, "Plan Width": 220, "Actual Startup Time": 502.382, "Actual Total Time": 1485.394, "Actual Rows": 662, "Actual Loops": 1, "Inner Unique": false, "Join Filter": "((ws1.ca_county)::text = (ws3.ca_county)::text)", "Rows Removed by Join Filter": 1148109, "Plans": [{"Node Type": "CTE Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "CTE Name": "ws", "Alias": "ws1", "Startup Cost": 0.0, "Total Cost": 17962.42, "Plan Rows": 18, "Plan Width": 110, "Actual Startup Time": 437.765, "Actual Total Time": 438.91, "Actual Rows": 911, "Actual Loops": 1, "Filter": "((d_qoy = 1) AND (d_year = 1999))", "Rows Removed by Filter": 22409}, {"Node Type": "CTE Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Async Capable": false, "CTE Name": "ws", "Alias": "ws3", "Startup Cost": 0.0, "Total Cost": 17962.42, "Plan Rows": 18, "Plan Width": 110, "Actual Startup Time": 0.002, "Actual Total Time": 1.115, "Actual Rows": 1261, "Actual Loops": 911, "Filter": "((d_year = 1999) AND (d_qoy = 3))", "Rows Removed by Filter": 22059}]}, {"Node Type": "CTE Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Async Capable": false, "CTE Name": "ss", "Alias": "ss1", "Startup Cost": 0.0, "Total Cost": 37104.6, "Plan Rows": 37, "Plan Width": 114, "Actual Startup Time": 2.284, "Actual Total Time": 4.005, "Actual Rows": 1647, "Actual Loops": 662, "Filter": "((d_qoy = 1) AND (d_year = 1999))", "Rows Removed by Filter": 33489}]}, {"Node Type": "CTE Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Async Capable": false, "CTE Name": "ss", "Alias": "ss2", "Startup Cost": 0.0, "Total Cost": 37104.6, "Plan Rows": 37, "Plan Width": 110, "Actual Startup Time": 0.0, "Actual Total Time": 1.589, "Actual Rows": 1635, "Actual Loops": 617, "Filter": "((d_year = 1999) AND (d_qoy = 2))", "Rows Removed by Filter": 33501}]}, {"Node Type": "CTE Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Async Capable": false, "CTE Name": "ss", "Alias": "ss3", "Startup Cost": 0.0, "Total Cost": 37104.6, "Plan Rows": 37, "Plan Width": 110, "Actual Startup Time": 0.003, "Actual Total Time": 1.871, "Actual Rows": 1798, "Actual Loops": 578, "Filter": "((d_year = 1999) AND (d_qoy = 3))", "Rows Removed by Filter": 33338}]}, {"Node Type": "CTE Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Async Capable": false, "CTE Name": "ws", "Alias": "ws2", "Startup Cost": 0.0, "Total Cost": 17962.42, "Plan Rows": 18, "Plan Width": 110, "Actual Startup Time": 0.004, "Actual Total Time": 1.047, "Actual Rows": 925, "Actual Loops": 570, "Filter": "((d_year = 1999) AND (d_qoy = 2))", "Rows Removed by Filter": 22395}]}]}, "Planning Time": 0.781, "Triggers": [], "Execution Time": 6925.204}]
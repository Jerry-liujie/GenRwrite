[{"Plan": {"Node Type": "Limit", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 288816.79, "Total Cost": 288818.35, "Plan Rows": 100, "Plan Width": 110, "Actual Startup Time": 567.779, "Actual Total Time": 567.818, "Actual Rows": 10, "Actual Loops": 1, "Plans": [{"Node Type": "Merge Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 288816.79, "Total Cost": 289075.44, "Plan Rows": 16635, "Plan Width": 110, "Actual Startup Time": 567.778, "Actual Total Time": 567.817, "Actual Rows": 10, "Actual Loops": 1, "Inner Unique": false, "Merge Cond": "(v11.rnk = v21.rnk)", "Plans": [{"Node Type": "Sort", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 144408.4, "Total Cost": 144412.96, "Plan Rows": 1824, "Plan Width": 59, "Actual Startup Time": 294.621, "Actual Total Time": 294.645, "Actual Rows": 10, "Actual Loops": 1, "Sort Key": ["v11.rnk"], "Sort Method": "quicksort", "Sort Space Used": 26, "Sort Space Type": "Memory", "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 144140.68, "Total Cost": 144309.6, "Plan Rows": 1824, "Plan Width": 59, "Actual Startup Time": 291.603, "Actual Total Time": 294.641, "Actual Rows": 10, "Actual Loops": 1, "Inner Unique": true, "Hash Cond": "(v11.item_sk = i1.i_item_sk)", "Plans": [{"Node Type": "Subquery Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Alias": "v11", "Startup Cost": 142505.68, "Total Cost": 142669.81, "Plan Rows": 1824, "Plan Width": 12, "Actual Startup Time": 285.753, "Actual Total Time": 288.786, "Actual Rows": 10, "Actual Loops": 1, "Filter": "(v11.rnk < 11)", "Rows Removed by Filter": 8411, "Plans": [{"Node Type": "WindowAgg", "Parent Relationship": "Subquery", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 142505.68, "Total Cost": 142601.42, "Plan Rows": 5471, "Plan Width": 44, "Actual Startup Time": 285.752, "Actual Total Time": 288.594, "Actual Rows": 8421, "Actual Loops": 1, "Plans": [{"Node Type": "Sort", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 142505.68, "Total Cost": 142519.36, "Plan Rows": 5471, "Plan Width": 36, "Actual Startup Time": 285.745, "Actual Total Time": 286.141, "Actual Rows": 8421, "Actual Loops": 1, "Sort Key": ["v1.rank_col"], "Sort Method": "quicksort", "Sort Space Used": 966, "Sort Space Type": "Memory", "Plans": [{"Node Type": "Subquery Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Alias": "v1", "Startup Cost": 137747.63, "Total Cost": 142166.0, "Plan Rows": 5471, "Plan Width": 36, "Actual Startup Time": 261.081, "Actual Total Time": 284.402, "Actual Rows": 8421, "Actual Loops": 1, "Plans": [{"Node Type": "Aggregate", "Strategy": "Sorted", "Partial Mode": "Finalize", "Parent Relationship": "Subquery", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 137747.63, "Total Cost": 142111.29, "Plan Rows": 5471, "Plan Width": 36, "Actual Startup Time": 261.08, "Actual Total Time": 284.052, "Actual Rows": 8421, "Actual Loops": 1, "Group Key": ["ss1.ss_item_sk"], "Filter": "(avg(ss1.ss_net_profit) > (0.9 * $1))", "Rows Removed by Filter": 9578, "Plans": [{"Node Type": "Aggregate", "Strategy": "Sorted", "Partial Mode": "Finalize", "Parent Relationship": "InitPlan", "Subplan Name": "InitPlan 1 (returns $1)", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 1000.0, "Total Cost": 67741.28, "Plan Rows": 6, "Plan Width": 36, "Actual Startup Time": 103.296, "Actual Total Time": 103.31, "Actual Rows": 1, "Actual Loops": 1, "Group Key": ["store_sales.ss_store_sk"], "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 1000.0, "Total Cost": 67741.12, "Plan Rows": 12, "Plan Width": 36, "Actual Startup Time": 103.201, "Actual Total Time": 103.3, "Actual Rows": 3, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Aggregate", "Strategy": "Sorted", "Partial Mode": "Partial", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 0.0, "Total Cost": 66739.92, "Plan Rows": 6, "Plan Width": 36, "Actual Startup Time": 101.445, "Actual Total Time": 101.446, "Actual Rows": 1, "Actual Loops": 3, "Group Key": ["store_sales.ss_store_sk"], "Workers": [], "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Async Capable": false, "Relation Name": "store_sales", "Alias": "store_sales", "Startup Cost": 0.0, "Total Cost": 66698.03, "Plan Rows": 8363, "Plan Width": 10, "Actual Startup Time": 0.034, "Actual Total Time": 100.768, "Actual Rows": 3592, "Actual Loops": 3, "Filter": "((ss_hdemo_sk IS NULL) AND (ss_store_sk = 4))", "Rows Removed by Filter": 956543, "Workers": []}]}]}]}, {"Node Type": "Gather Merge", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 70006.35, "Total Cost": 73836.55, "Plan Rows": 32828, "Plan Width": 36, "Actual Startup Time": 157.77, "Actual Total Time": 163.014, "Actual Rows": 53691, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Plans": [{"Node Type": "Sort", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 69006.33, "Total Cost": 69047.36, "Plan Rows": 16414, "Plan Width": 36, "Actual Startup Time": 155.065, "Actual Total Time": 155.619, "Actual Rows": 17897, "Actual Loops": 3, "Sort Key": ["ss1.ss_item_sk"], "Sort Method": "quicksort", "Sort Space Used": 3104, "Sort Space Type": "Memory", "Workers": [{"Worker Number": 0, "Sort Method": "quicksort", "Sort Space Used": 3105, "Sort Space Type": "Memory"}, {"Worker Number": 1, "Sort Method": "quicksort", "Sort Space Used": 3099, "Sort Space Type": "Memory"}], "Plans": [{"Node Type": "Aggregate", "Strategy": "Hashed", "Partial Mode": "Partial", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 67651.96, "Total Cost": 67857.13, "Plan Rows": 16414, "Plan Width": 36, "Actual Startup Time": 138.83, "Actual Total Time": 152.548, "Actual Rows": 17897, "Actual Loops": 3, "Group Key": ["ss1.ss_item_sk"], "Planned Partitions": 0, "HashAgg Batches": 5, "Peak Memory Usage": 4273, "Disk Usage": 3440, "Workers": [{"Worker Number": 0, "HashAgg Batches": 5, "Peak Memory Usage": 4273, "Disk Usage": 3448}, {"Worker Number": 1, "HashAgg Batches": 5, "Peak Memory Usage": 4273, "Disk Usage": 3432}], "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Async Capable": false, "Relation Name": "store_sales", "Alias": "ss1", "Startup Cost": 0.0, "Total Cost": 66698.03, "Plan Rows": 190786, "Plan Width": 10, "Actual Startup Time": 0.035, "Actual Total Time": 91.535, "Actual Rows": 152757, "Actual Loops": 3, "Filter": "(ss_store_sk = 4)", "Rows Removed by Filter": 807377, "Workers": []}]}]}]}]}]}]}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 1410.0, "Total Cost": 1410.0, "Plan Rows": 18000, "Plan Width": 55, "Actual Startup Time": 5.844, "Actual Total Time": 5.844, "Actual Rows": 18000, "Actual Loops": 1, "Hash Buckets": 32768, "Original Hash Buckets": 32768, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 1802, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Relation Name": "item", "Alias": "i1", "Startup Cost": 0.0, "Total Cost": 1410.0, "Plan Rows": 18000, "Plan Width": 55, "Actual Startup Time": 0.003, "Actual Total Time": 4.725, "Actual Rows": 18000, "Actual Loops": 1}]}]}]}, {"Node Type": "Sort", "Parent Relationship": "Inner", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 144408.4, "Total Cost": 144412.96, "Plan Rows": 1824, "Plan Width": 59, "Actual Startup Time": 273.155, "Actual Total Time": 273.168, "Actual Rows": 10, "Actual Loops": 1, "Sort Key": ["v21.rnk"], "Sort Method": "quicksort", "Sort Space Used": 26, "Sort Space Type": "Memory", "Plans": [{"Node Type": "Hash Join", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 144140.68, "Total Cost": 144309.6, "Plan Rows": 1824, "Plan Width": 59, "Actual Startup Time": 270.35, "Actual Total Time": 273.161, "Actual Rows": 10, "Actual Loops": 1, "Inner Unique": true, "Hash Cond": "(v21.item_sk = i2.i_item_sk)", "Plans": [{"Node Type": "Subquery Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Alias": "v21", "Startup Cost": 142505.68, "Total Cost": 142669.81, "Plan Rows": 1824, "Plan Width": 12, "Actual Startup Time": 265.516, "Actual Total Time": 268.322, "Actual Rows": 10, "Actual Loops": 1, "Filter": "(v21.rnk < 11)", "Rows Removed by Filter": 8411, "Plans": [{"Node Type": "WindowAgg", "Parent Relationship": "Subquery", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 142505.68, "Total Cost": 142601.42, "Plan Rows": 5471, "Plan Width": 44, "Actual Startup Time": 265.515, "Actual Total Time": 268.139, "Actual Rows": 8421, "Actual Loops": 1, "Plans": [{"Node Type": "Sort", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 142505.68, "Total Cost": 142519.36, "Plan Rows": 5471, "Plan Width": 36, "Actual Startup Time": 265.51, "Actual Total Time": 265.765, "Actual Rows": 8421, "Actual Loops": 1, "Sort Key": ["v2.rank_col DESC"], "Sort Method": "quicksort", "Sort Space Used": 966, "Sort Space Type": "Memory", "Plans": [{"Node Type": "Subquery Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Alias": "v2", "Startup Cost": 137747.63, "Total Cost": 142166.0, "Plan Rows": 5471, "Plan Width": 36, "Actual Startup Time": 242.344, "Actual Total Time": 264.198, "Actual Rows": 8421, "Actual Loops": 1, "Plans": [{"Node Type": "Aggregate", "Strategy": "Sorted", "Partial Mode": "Finalize", "Parent Relationship": "Subquery", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 137747.63, "Total Cost": 142111.29, "Plan Rows": 5471, "Plan Width": 36, "Actual Startup Time": 242.343, "Actual Total Time": 263.868, "Actual Rows": 8421, "Actual Loops": 1, "Group Key": ["ss1_1.ss_item_sk"], "Filter": "(avg(ss1_1.ss_net_profit) > (0.9 * $3))", "Rows Removed by Filter": 9578, "Plans": [{"Node Type": "Aggregate", "Strategy": "Sorted", "Partial Mode": "Finalize", "Parent Relationship": "InitPlan", "Subplan Name": "InitPlan 2 (returns $3)", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 1000.0, "Total Cost": 67741.28, "Plan Rows": 6, "Plan Width": 36, "Actual Startup Time": 84.479, "Actual Total Time": 84.485, "Actual Rows": 1, "Actual Loops": 1, "Group Key": ["store_sales_1.ss_store_sk"], "Plans": [{"Node Type": "Gather", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 1000.0, "Total Cost": 67741.12, "Plan Rows": 12, "Plan Width": 36, "Actual Startup Time": 84.381, "Actual Total Time": 84.477, "Actual Rows": 3, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Single Copy": false, "Plans": [{"Node Type": "Aggregate", "Strategy": "Sorted", "Partial Mode": "Partial", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 0.0, "Total Cost": 66739.92, "Plan Rows": 6, "Plan Width": 36, "Actual Startup Time": 82.715, "Actual Total Time": 82.715, "Actual Rows": 1, "Actual Loops": 3, "Group Key": ["store_sales_1.ss_store_sk"], "Workers": [], "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Async Capable": false, "Relation Name": "store_sales", "Alias": "store_sales_1", "Startup Cost": 0.0, "Total Cost": 66698.03, "Plan Rows": 8363, "Plan Width": 10, "Actual Startup Time": 0.037, "Actual Total Time": 82.087, "Actual Rows": 3592, "Actual Loops": 3, "Filter": "((ss_hdemo_sk IS NULL) AND (ss_store_sk = 4))", "Rows Removed by Filter": 956543, "Workers": []}]}]}]}, {"Node Type": "Gather Merge", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 70006.35, "Total Cost": 73836.55, "Plan Rows": 32828, "Plan Width": 36, "Actual Startup Time": 157.853, "Actual Total Time": 162.436, "Actual Rows": 53679, "Actual Loops": 1, "Workers Planned": 2, "Workers Launched": 2, "Plans": [{"Node Type": "Sort", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 69006.33, "Total Cost": 69047.36, "Plan Rows": 16414, "Plan Width": 36, "Actual Startup Time": 155.831, "Actual Total Time": 156.381, "Actual Rows": 17893, "Actual Loops": 3, "Sort Key": ["ss1_1.ss_item_sk"], "Sort Method": "quicksort", "Sort Space Used": 3101, "Sort Space Type": "Memory", "Workers": [{"Worker Number": 0, "Sort Method": "quicksort", "Sort Space Used": 3104, "Sort Space Type": "Memory"}, {"Worker Number": 1, "Sort Method": "quicksort", "Sort Space Used": 3100, "Sort Space Type": "Memory"}], "Plans": [{"Node Type": "Aggregate", "Strategy": "Hashed", "Partial Mode": "Partial", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 67651.96, "Total Cost": 67857.13, "Plan Rows": 16414, "Plan Width": 36, "Actual Startup Time": 140.844, "Actual Total Time": 153.535, "Actual Rows": 17893, "Actual Loops": 3, "Group Key": ["ss1_1.ss_item_sk"], "Planned Partitions": 0, "HashAgg Batches": 5, "Peak Memory Usage": 4273, "Disk Usage": 3440, "Workers": [{"Worker Number": 0, "HashAgg Batches": 5, "Peak Memory Usage": 4273, "Disk Usage": 3424}, {"Worker Number": 1, "HashAgg Batches": 5, "Peak Memory Usage": 4273, "Disk Usage": 3424}], "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Async Capable": false, "Relation Name": "store_sales", "Alias": "ss1_1", "Startup Cost": 0.0, "Total Cost": 66698.03, "Plan Rows": 190786, "Plan Width": 10, "Actual Startup Time": 0.028, "Actual Total Time": 93.01, "Actual Rows": 152757, "Actual Loops": 3, "Filter": "(ss_store_sk = 4)", "Rows Removed by Filter": 807377, "Workers": []}]}]}]}]}]}]}]}]}, {"Node Type": "Hash", "Parent Relationship": "Inner", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 1410.0, "Total Cost": 1410.0, "Plan Rows": 18000, "Plan Width": 55, "Actual Startup Time": 4.826, "Actual Total Time": 4.826, "Actual Rows": 18000, "Actual Loops": 1, "Hash Buckets": 32768, "Original Hash Buckets": 32768, "Hash Batches": 1, "Original Hash Batches": 1, "Peak Memory Usage": 1802, "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Relation Name": "item", "Alias": "i2", "Startup Cost": 0.0, "Total Cost": 1410.0, "Plan Rows": 18000, "Plan Width": 55, "Actual Startup Time": 0.012, "Actual Total Time": 3.589, "Actual Rows": 18000, "Actual Loops": 1}]}]}]}]}]}, "Planning Time": 0.209, "Triggers": [], "Execution Time": 569.507}]
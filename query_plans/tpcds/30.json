[{"Plan": {"Node Type": "Limit", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 7658.79, "Total Cost": 7658.8, "Plan Rows": 3, "Plan Width": 246, "Actual Startup Time": 8226.713, "Actual Total Time": 8226.746, "Actual Rows": 63, "Actual Loops": 1, "Plans": [{"Node Type": "Aggregate", "Strategy": "Sorted", "Partial Mode": "Finalize", "Parent Relationship": "InitPlan", "Subplan Name": "CTE customer_total_return", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 4376.38, "Total Cost": 4408.14, "Plan Rows": 325, "Plan Width": 39, "Actual Startup Time": 23.538, "Actual Total Time": 32.064, "Actual Rows": 13143, "Actual Loops": 1, "Group Key": ["web_returns.wr_returning_customer_sk", "customer_address_1.ca_state"], "Plans": [{"Node Type": "Gather Merge", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 4376.38, "Total Cost": 4402.17, "Plan Rows": 191, "Plan Width": 39, "Actual Startup Time": 23.533, "Actual Total Time": 27.227, "Actual Rows": 13182, "Actual Loops": 1, "Workers Planned": 1, "Workers Launched": 1, "Plans": [{"Node Type": "Aggregate", "Strategy": "Sorted", "Partial Mode": "Partial", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 3376.37, "Total Cost": 3380.67, "Plan Rows": 191, "Plan Width": 39, "Actual Startup Time": 22.105, "Actual Total Time": 24.444, "Actual Rows": 6591, "Actual Loops": 2, "Group Key": ["web_returns.wr_returning_customer_sk", "customer_address_1.ca_state"], "Workers": [], "Plans": [{"Node Type": "Sort", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 3376.37, "Total Cost": 3376.85, "Plan Rows": 191, "Plan Width": 13, "Actual Startup Time": 22.096, "Actual Total Time": 22.332, "Actual Rows": 6648, "Actual Loops": 2, "Sort Key": ["web_returns.wr_returning_customer_sk", "customer_address_1.ca_state"], "Sort Method": "quicksort", "Sort Space Used": 550, "Sort Space Type": "Memory", "Workers": [{"Worker Number": 0, "Sort Method": "quicksort", "Sort Space Used": 458, "Sort Space Type": "Memory"}], "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 0.59, "Total Cost": 3369.13, "Plan Rows": 191, "Plan Width": 13, "Actual Startup Time": 0.077, "Actual Total Time": 20.937, "Actual Rows": 6648, "Actual Loops": 2, "Inner Unique": true, "Workers": [], "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 0.3, "Total Cost": 3293.97, "Plan Rows": 200, "Plan Width": 14, "Actual Startup Time": 0.06, "Actual Total Time": 11.768, "Actual Rows": 6817, "Actual Loops": 2, "Inner Unique": true, "Workers": [], "Plans": [{"Node Type": "Seq Scan", "Parent Relationship": "Outer", "Parallel Aware": true, "Async Capable": false, "Relation Name": "web_returns", "Alias": "web_returns", "Startup Cost": 0.0, "Total Cost": 1749.14, "Plan Rows": 42214, "Plan Width": 18, "Actual Startup Time": 0.011, "Actual Total Time": 3.664, "Actual Rows": 35882, "Actual Loops": 2, "Workers": []}, {"Node Type": "Memoize", "Parent Relationship": "Inner", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 0.3, "Total Cost": 0.41, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.0, "Actual Total Time": 0.0, "Actual Rows": 0, "Actual Loops": 71763, "Cache Key": "web_returns.wr_returned_date_sk", "Cache Mode": "logical", "Cache Hits": 39548, "Cache Misses": 2093, "Cache Evictions": 0, "Cache Overflows": 0, "Peak Memory Usage": 152, "Workers": [{"Worker Number": 0, "Cache Hits": 28050, "Cache Misses": 2072, "Cache Evictions": 0, "Cache Overflows": 0, "Peak Memory Usage": 151}], "Plans": [{"Node Type": "Index Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Scan Direction": "Forward", "Index Name": "date_dim_pkey", "Relation Name": "date_dim", "Alias": "date_dim", "Startup Cost": 0.29, "Total Cost": 0.4, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 0, "Actual Loops": 4165, "Index Cond": "(d_date_sk = web_returns.wr_returned_date_sk)", "Rows Removed by Index Recheck": 0, "Filter": "(d_year = 2000)", "Rows Removed by Filter": 1, "Workers": []}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Async Capable": false, "Scan Direction": "Forward", "Index Name": "customer_address_pkey", "Relation Name": "customer_address", "Alias": "customer_address_1", "Startup Cost": 0.29, "Total Cost": 0.38, "Plan Rows": 1, "Plan Width": 7, "Actual Startup Time": 0.001, "Actual Total Time": 0.001, "Actual Rows": 1, "Actual Loops": 13634, "Index Cond": "(ca_address_sk = web_returns.wr_returning_addr_sk)", "Rows Removed by Index Recheck": 0, "Workers": []}]}]}]}]}]}, {"Node Type": "Sort", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 3250.66, "Total Cost": 3250.66, "Plan Rows": 3, "Plan Width": 246, "Actual Startup Time": 8226.712, "Actual Total Time": 8226.714, "Actual Rows": 63, "Actual Loops": 1, "Sort Key": ["customer.c_customer_id", "customer.c_salutation", "customer.c_first_name", "customer.c_last_name", "customer.c_preferred_cust_flag", "customer.c_birth_day", "customer.c_birth_month", "customer.c_birth_year", "customer.c_birth_country", "customer.c_login", "customer.c_email_address", "customer.c_last_review_date_sk", "ctr1.ctr_total_return"], "Sort Method": "quicksort", "Sort Space Used": 41, "Sort Space Type": "Memory", "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 0.58, "Total Cost": 3250.63, "Plan Rows": 3, "Plan Width": 246, "Actual Startup Time": 78.619, "Actual Total Time": 8226.428, "Actual Rows": 63, "Actual Loops": 1, "Inner Unique": true, "Plans": [{"Node Type": "Nested Loop", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "Join Type": "Inner", "Startup Cost": 0.29, "Total Cost": 3211.86, "Plan Rows": 108, "Plan Width": 250, "Actual Startup Time": 35.149, "Actual Total Time": 8215.323, "Actual Rows": 3185, "Actual Loops": 1, "Inner Unique": true, "Plans": [{"Node Type": "CTE Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "CTE Name": "customer_total_return", "Alias": "ctr1", "Startup Cost": 0.0, "Total Cost": 2390.38, "Plan Rows": 108, "Plan Width": 36, "Actual Startup Time": 35.129, "Actual Total Time": 8202.332, "Actual Rows": 3204, "Actual Loops": 1, "Filter": "(ctr_total_return > (SubPlan 2))", "Rows Removed by Filter": 9939, "Plans": [{"Node Type": "Aggregate", "Strategy": "Plain", "Partial Mode": "Simple", "Parent Relationship": "SubPlan", "Subplan Name": "SubPlan 2", "Parallel Aware": false, "Async Capable": false, "Startup Cost": 7.32, "Total Cost": 7.33, "Plan Rows": 1, "Plan Width": 32, "Actual Startup Time": 0.622, "Actual Total Time": 0.622, "Actual Rows": 1, "Actual Loops": 13143, "Plans": [{"Node Type": "CTE Scan", "Parent Relationship": "Outer", "Parallel Aware": false, "Async Capable": false, "CTE Name": "customer_total_return", "Alias": "ctr2", "Startup Cost": 0.0, "Total Cost": 7.31, "Plan Rows": 2, "Plan Width": 32, "Actual Startup Time": 0.017, "Actual Total Time": 0.603, "Actual Rows": 381, "Actual Loops": 13143, "Filter": "(ctr1.ctr_state = ctr_state)", "Rows Removed by Filter": 12762}]}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Async Capable": false, "Scan Direction": "Forward", "Index Name": "customer_pkey", "Relation Name": "customer", "Alias": "customer", "Startup Cost": 0.29, "Total Cost": 7.61, "Plan Rows": 1, "Plan Width": 222, "Actual Startup Time": 0.003, "Actual Total Time": 0.003, "Actual Rows": 1, "Actual Loops": 3204, "Index Cond": "(c_customer_sk = ctr1.ctr_customer_sk)", "Rows Removed by Index Recheck": 0}]}, {"Node Type": "Index Scan", "Parent Relationship": "Inner", "Parallel Aware": false, "Async Capable": false, "Scan Direction": "Forward", "Index Name": "customer_address_pkey", "Relation Name": "customer_address", "Alias": "customer_address", "Startup Cost": 0.29, "Total Cost": 0.36, "Plan Rows": 1, "Plan Width": 4, "Actual Startup Time": 0.003, "Actual Total Time": 0.003, "Actual Rows": 0, "Actual Loops": 3185, "Index Cond": "(ca_address_sk = customer.c_current_addr_sk)", "Rows Removed by Index Recheck": 0, "Filter": "(ca_state = 'AR'::bpchar)", "Rows Removed by Filter": 1}]}]}]}, "Planning Time": 0.428, "Triggers": [], "Execution Time": 8226.944}]